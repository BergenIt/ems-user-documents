# Руководство пользователя EMS версия 4.2

## Аннотация <!-- {docsify-ignore} -->

"Element Management System" ("Система управления объектами инфраструктуры") (далее – Система, EMS) – геораспределенная система для инвентаризации, мониторинга и управления объектами инфраструктуры.

Документ содержит справочную информацию по использованию ПО EMS версии 4.2.

Настоящий документ является составной частью комплекта технической документации на систему EMS и разработан в соответствии с требованиями ГОСТ 2.105-95 «Единая система конструкторской документации. Общие требования к текстовым документам».

## 1 Введение

### 1.1	Область применения

Система EMS предназначена для решения следующих бизнес-задач в IT-инфраструктуре компании: 

- Снижение расходов на использование нескольких систем, за счет централизованного мониторинга аппаратных и программных (виртуальные машины, гипервизоры, сервисы) ОМиУ (объектов мониторинга и управления) в Системе;
- Снижение времени на выполнение задач по обновлению и установке операционных систем и прошивок, за счет централизованной панели управления и возможности массового запуска операций на ОМиУ;
- Снижение времени реагирования на инциденты, за счет формирования необходимого представления инфраструктуры, выделения ОМиУ, требующих более пристального внимания и возможности настройки разных способов оповещения о событиях. 

### 1.2	Функциональное назначение Системы

Система EMS предназначена для:

- Автоматизации задач управления серверным оборудованием;
- Автоматизации задач управления сетевым оборудованием;
- Мониторинга в режиме реального времени доступности серверов, устройств хранения и сетевых коммутаторов;
- Мониторинга виртуальных машин, гипервизоров, систем и сервисов;
- Мониторинга компонентов серверного оборудования;
- Автоматизации развертывания операционных систем и программного обеспечения;
- Предоставления информации для планирования модернизации оборудования ИТ-инфраструктуры.

Система представляет собой композицию docker-контейнеров. В качестве оркестратора контейнеров используется `docker-compose`.

### 1.3	Перечень эксплуатационной документации

Перед началом использования Системы, пользователь должен ознакомиться с текущим руководством пользователя.

### 1.4 Термины и определения

**Система EMS**

| Наименование | Описание |
| --- | --- |
| **EMS**, **Система**   | Element Management System (EMS) - система управления и мониторинга оборудования |
| **Docker**                | Программное обеспечение для автоматизации развёртывания и управления приложениями в средах с поддержкой контейнеризации, контейнеризатор приложений |
| **Docker compose**        | Средство для определения и запуска приложений Docker с несколькими контейнерами |
| **single-node**           | ВМ для размещения EMS |
| **master_cluster**        | Группа сервисов EMS уровней middle и frontend |
| **tool_cluster**          | Группа сервисов EMS уровня бэк-энд |
| **transport_cluster**     | Группа инфраструктурных сервисов. (До EMS 3.3.0 `storage_cluster`) |

**Общие термины и определения**

| Наименование | Описание |
| --- | --- |
| **Bash** |	(англ. Bourne again shell) - усовершенствованная и модернизированная вариация командной оболочки Bourne shell. Одна из наиболее популярных современных разновидностей командной оболочки UNIX. Особенно популярна в среде Linux, где она часто используется в качестве предустановленной командной оболочки |
| **BIOS** |	(англ. Basic Input-Output System) базовая система ввода-вывода BMC Контроллер управления материнской платой для дистанционного мониторинга и управления серверными платами|
| **BMC** | (англ. Baseboard Management Controller) - ядро системы управления серверной платформой, которое практически является специализированным компьютером, встроенным в серверную платформу, имеющим свои собственные процессор, память, периферийное оборудование и операционную систему |
| **Cumulus** | Cumulus Linux -  специализированная сетевая операционная система, созданная для работы на коммутаторах без операционной системы с установочной средой ONIE. Создана компанией Cumulus Networks для коммутаторов, используемых в дата-центрах и призвана расширить функциональные возможности коммутаторов за счёт использования стандартных Linux-приложений для оркестрации, управления, настройки и автоматизации функционирования |
| **gRPC** | Протокол межсервисного взаимодействия |
| **HTTP** | (англ. Hypertext Transfer Protocol — протокол передачи гипертекста), протокол прикладного уровня для передачи произвольных данных |
| **IPMI** | Интеллектуальный интерфейс управления платформой, предназначенный для автономного мониторинга и управления функциями, встроенными непосредственно в аппаратное и микропрограммное обеспечения серверных платформ |
| **ISO**	| (англ. International Organization for Standardization) Термин для обозначения образа оптического диска, содержащего файловую систему стандарта ISO 9660|
| **Kickstart**	| Метод быстрой установки операционных систем, основанных на Red Hat Linux |
| **MIB** | (англ. Management Information Base - MIB, база управляющей информации) - виртуальная база данных, используемая для управления объектами в сети связи. Наиболее часто это понятие связывают с Simple Network Management Protocol (SNMP), но также оно используется в более широком смысле - в контексте модели управления сети OSI/ISO |
| **NMI** | (англ. Non-maskable interrupt - немаскируемое прерывание) – это специальное прерывание, которое не может быть замаскировано, с использованием стандартной технологии маскирования прерываний. NMI генерируется, как правило, при появлении невосстанавливаемой аппаратной ошибки. Некоторые NMI могут быть замаскированы с использованием специальных методов |
| **PowerPushButton** | Выключение (Soft-off) оборудования имитируя четырехсекундное удержание кнопки питания, доступно по протоколу Redfish | 
| **PowerShell** | Windows PowerShell скрипт - это текстовый файл, содержащий одну или несколько команд PowerShell. Файлы с PowerShell скриптом имеют расширение ".ps1" |
| **QEMU-base** | Универсальный эмулятор виртуальных машин с открытым исходным кодом |
| **Redfish** | Набор спецификаций, которые обеспечивают стандартный отраслевой протокол, обеспечивающий интерфейс RESTful для управления серверами, хранилищем, сетью и конвергентной инфраструктурой |
|**SIEM**|англ. Security information and event management — система управления безопасностью в части информации и событий| 
| **SFTP** | (англ. SSH File Transfer Protocol) — протокол прикладного уровня. Предназначен для копирования и выполнения других операций с файлами поверх надёжного и безопасного соединения |
| **Sh** |  (англ. Shell script) Сценарий командной строки или сценарий командной оболочки — программа, выполняемая командной оболочкой операционной системы. Наиболее часто термин применяется к скриптам, написанным для Bourne shell — программной оболочки систем UNIX |
| **SMTP** |	(англ. Simple Mail Transfer Protocol) - сетевой протокол, предназначенный для передачи электронной почты в сетях TCP/IP |
| **SMART** |Технология оценки состояния жёсткого диска встроенной аппаратурой самодиагностики|
| **SNMP** | (англ. Simple Network Management Protocol) - протокол, который используется для управления сетевыми устройствами. С помощью протокола SNMP, программное обеспечение для управления сетевыми устройствами может получать доступ к информации, которая хранится на управляемых устройствах |
| **SSH**	| (англ. Secure Shell ) - сетевой протокол прикладного уровня, позволяющий производить удалённое управление операционной системой и туннелирование TCP-соединений |
| **SUDO** |  (англ. Substitute User and do, дословно «подменить пользователя и выполнить») — программа для системного администрирования UNIX-систем, позволяющая делегировать те или иные привилегированные ресурсы пользователям с ведением протокола работы. Основная идея — дать пользователям как можно меньше прав, при этом достаточных для решения поставленных задач |
| **TCP/IP** |	(англ. Transmission Control Protocol и Internet Protocol) — сетевая модель передачи данных, представленных в цифровом виде. Модель описывает способ передачи данных от источника информации к получателю |
| **TCP** | Протокол передачи данных |
| **Tool-cluster** | Распределенный кластер системы, представляющий из себя набор сервисов, необходимых для обращения к объектам мониторинга и нормализации полученных данных |
| **UDP** |	(англ. User Datagram Protocol) - один из ключевых элементов набора сетевых протоколов для Интернета. С UDP компьютерные приложения могут посылать сообщения другим хостам по IP-сети без необходимости предварительного сообщения для установки специальных каналов передачи или путей данных |
| **UEFI** | (англ. Unified Extensible Firmware Interface - единый интерфейс расширяемой прошивки) - интерфейс между операционной системой и микропрограммами, управляющими низкоуровневыми функциями оборудования, его основное предназначение: корректно инициализировать оборудование при включении системы и передать управление загрузчику или непосредственно ядру операционной системы |
| **VmWare ESXI** | Встроенный гипервизор, установленный непосредственно на «голое железо», то есть вместо базовой операционной системы |
| **WMI** | Протокол для централизованного управления и мониторинга компьютерной инфраструктуры под управлением платформы Windows |
| **WS** | WebSocket — протокол связи поверх TCP-соединения, предназначенный для обмена сообщениями между браузером и веб-сервером в режиме реального времени |
| **Zabbix**	| Свободная система мониторинга и отслеживания статусов разнообразных сервисов компьютерной сети, серверов и сетевого оборудования |
| **АРМ** | Автоматизированное рабочее место - рабочее место специалиста, оснащенное персональным компьютером, программным обеспечением и совокупностью информационных ресурсов индивидуального или коллективного пользования. |
| **Гипервизор** |  Программа или аппаратная схема, обеспечивающая или позволяющая одновременное, параллельное выполнение нескольких операционных систем на одном и том же хост-компьютере. Гипервизор также обеспечивает изоляцию операционных систем друг от друга, защиту и безопасность, разделение ресурсов между различными запущенными ОС и управление ресурсами |
| **Директория** | Каталог, упрощающий организацию и управление ОМиУ |
| **ЛКМ** | Левая кнопка мыши (компьютерной) |
| **ПКМ** | Правая кнопка мыши (компьютерной) |
| **ОС** |	Операционная система |
| **ОМиУ** | Объект мониторинга и управления |
| **Хостнейм** | (с англ. hostname - имя хоста) - метка, которая присваивается устройству, подключенному к компьютерной сети, и используется для идентификации устройства в различных формах электронной связи | 

## 2 Назначение и условия применения

### 2.1 Виды деятельности и функции пользователей

Для эксплуатации системы рекомендуется создать пользователей со следующими ролями:

1. Администратор информационной безопасности:

  * Обеспечение информационной безопасности с помощью управления полномочиями пользователей Системы;
  * Аудит использования Системы.

2. Системный администратор:

  * Подготовка инфраструктуры для установки Системы;
  * Установка Системы;
  * Первичное конфигурирование Системы;
  * Установка первой лицензии на Систему;
  * Эксплуатационное сопровождение и конфигурирование Системы;
  * Эксплуатационная установка лицензий на Систему;
  * Подготовка инфраструктуры для обновления Системы;
  * Обновление Системы.

3. Администратор инфраструктуры:

  * Создание и конфигурирование интеграционных узлов;
  * Мониторинг работоспособности сервисов Системы;
  * Анализ журналов функционирования и отладочной информации Системы.

### 2.2	Требования к операционной среде и программному обеспечению

Клиентская часть Системы реализована в виде Web-интерфейса и работает в Web-браузерах (по релевантности):

* Яндекс Браузер, версия не ниже 22.9.5;
* Браузер Google Chrome, версия не ниже 113.0.5672.93 (Официальная сборка), 64 бит.

Общие требования к АРМ оператора:

1. Для обеспечения функционирования клиентской части ПО EMS, рабочий компьютер пользователя должен удовлетворять следующим минимальным требованиям: 

  * Процессор производительностью не ниже i5 9400+; 
  * Минимум 8 Гб памяти; 
  * Минимум 20 Гб свободного места на HDD или SSD; 
  * Минимальное разрешение экрана пользователя не менее 1920x1080 пикселей; 
  * Пропускная способность сетевого канала связи между компьютером пользователя и сервером должно составлять не менее 20 Мбит/сек, время прохождения пакетов не более 100 мс.

2. Операционная система должна обладать GUI.

3. Для обеспечения корректного функционирования ПО EMS, программное обеспечение АРМ должно использовать следующие настройки по умолчанию:

  * Масштаб в web-браузере 100%;
  * Размер шрифтов в ОС без масштабирования (100%).

## 3 Подготовка к работе

### 3.1 Состав и содержание дистрибутивного носителя данных

Для работы с Системой EMS необходимо следующее программное обеспечение:

* Браузер:

  * Основной: Яндекс-браузер (устанавливается отдельно);
  * Альтернативный: Google Chrome (устанавливается отдельно).

### 3.2 Порядок загрузки данных и программ

Перед началом работы с Системой EMS на рабочем месте пользователя необходимо выполнить следующие действия:

* Если компьютер пользователя находится внутри корпоративной сети, то необходимо: 

  * Проверить, что кластера системы развернуты в одной сети с оборудованием; 
  * Проверить доступность ПО EMS.
  
* Если компьютер пользователя находится вне корпоративной сети, то необходимо:

  * Проверить, что кластера системы развернуты в одной сети с оборудованием; 
  * Настроить VPN для доступа к кластерам системы;
  * Проверить доступность ПО EMS.

## 4 Компоненты и функции интерфейса

### Компоненты настройки отображения данных 

**Пагинация**

Для удобного отображения большого объема информации в одном окне в системе предусмотрен функционал пагинации. Если количество объектов в окне, превышает количество объектов возможных для отображения на странице, то для отображения нужно перейти на следующую страницу. 

**Сортировка**

Для удобного поиска требуемой информации в множестве значений в системе реализован функционал сортировки.  Сортировка возможна по текстовым полям таблиц системы. 

> ***Сортировка полей доступна на уровне табличного отображения данных***

### Компоненты поиска объектов физического и логического проводника

**Глобальный поиск**

Отвечает за поиск объектов по всей системе. Сортировка результатов поиска может быть произведена за счет выбора отображаемой структуры в виде логического или физического вида проводника системы. 

![Глобальный поиск](./media/EMS_user_guide_files/EMS_global_search.png "Глобальный поиск")

> ***В случае отсутствия настроенного доступа к объекту, он не будет обнаружен и отображен в окне системы***
> 
> ***Набор полученных данных, при выборе отображения логического или физического вида проводника может отличаться***
> 
> ***Дополнительно, вызов окна глобального поиска может быть осуществлено с помощью сочетания клавиш "Ctrl" + "K" из интерфейса "Главный экран"***

**Поиск в логическом проводнике**

Отвечает за поиск объектов в рамках выбранной директории. 

Для удобного и более точного поиска объектов в выбранной директории, реализована возможность фильтрации запросов путем применения следующих параметров: 

* Серийный номер;
* Стойка;
* Хостнейм;
* Модель;
* Тип устройства;
* Производитель;
* Mac адрес;
* Ip адрес;
* Протокол.

> ***Возможно одновременное применение нескольких фильтров***
> 
> ***В системе реализована возможность поиска по инвентарным данным оборудования***

![Поиск в логическом проводнике](./media/EMS_user_guide_files/EMS_local_logic_search.png "Локальный поиск логического проводника")

**Поиск в физическом проводнике**

Отвечает за поиск объектов в рамках выбранного уровня структуры проводника. 

Для удобного и более точного поиска объектов на разных уровнях проводника, реализована возможность фильтрации запросов путем применения следующих параметров: 

* Для уровня здания, где размещены помещения:  

  * Название;
  * Описание.

* Для уровня помещения, где размещены серверные стойки:  

  * Название;
  * Серийный номер;
  * Высота;
  * Группа сопровождения;
  * Ширина стойки;
  * Юниты;
  * Устройства.

* Для уровня серверной стойки, где размещено оборудование:  

  * Серийный номер;
  * Хостнейм;
  * Модель;
  * Производитель;
  * Mac адрес;
  * Ip адрес;
  * Протокол.

> ***Возможно одновременное применение нескольких фильтров***
> 
> ***В системе реализована возможность поиска по инвентарным данным оборудования***

![Поиск в физическом проводнике](./media/EMS_user_guide_files/EMS_local_phys_search.png "Локальный поиск физического проводника")

## 5 Описание функциональности Системы

### 5.1 Вход в систему

#### 5.1.1 Авторизация

Для входа в пользовательский интерфейс системы EMS необходимо в браузере открыть стартовую страницу авторизации.

![Страница авторизации](./media/EMS_user_guide_files/EMS_authorization.png "Страница авторизации")

Для доступа к данным необходимо выполнить авторизацию: указать логин и пароль, а затем нажать кнопку "Войти в систему".

> ***В случае ввода некорректного пароля более 5 раз, доступ к учетной записи будет заблокирован на 24 часа***
>
> ***В случае отсутствия предварительных настроек права и доступы к функционалу системы и оборудованию, будут ограничены. Обратитесь к администратору системы для предоставления доступов***

#### 5.1.2 Восстановление пароля

Для восстановления пароля необходимо нажать кнопку "Забыли пароль" на стартовой странице авторизации. В открывшейся экранной форме ввести свой логин и код captcha. Далее нажмите кнопку "Сменить пароль".  

> ***При смене пароля, новый пароль должен отличаться от старого не менее чем на 4 символа***
> 
> ***Восстановление пароля не доступно для учетных записей AD***

![Страница восстановления пароля](./media/EMS_user_guide_files/EMS_recovery_pass.png "Страница восстановления пароля")

На почту, привязанную к учетной записи, будет отправлено письмо с инструкцией по восстановлению пароля. Следуйте указанным пунктам.

> ***Восстановление пароля через почту доступно только в случае подключеного к системе SMTP сервера***

### 5.2 Администрирование системы

Данный раздел включает в себя предварительные настройки администратором системы, для ее дальнейшей эксплуатации пользователями

#### 5.2.1 Управление лицензиями системы

Информация об активных лицензиях и управление ими расположены в разделе "Лицензии".
В меню лицензий отображен перечень и реквизиты используемых лицензий.

![Лицензии](./media/EMS_user_guide_files/EMS_license.png "Лицензии")

**Добавление лицензии**

Для активации новой лицензии нажмите "Импорт лицензии".
Укажите в проводнике путь к файлу лицензии и нажмите "Открыть".
Добавленная лицензия будет отображена на экране.  

**Удаление лицензии**

Выберите необходимые лицензии и нажмите "Удалить".  
Подтвердите удаление.  

> ***В системе присутствует ограничение на удаление последнего файла лицензии***

#### 5.2.2 Настройка LDAP подключения

> ***Предварительные настройки LDAP подключения можно произвести при первичной инсталляции системы***
> ***Перед настройка LDAP подключения в каталоге AD необходимо определить роли пользователей системы***

Для настройки LDAP подключения к системе перейдите в раздел "Настройка системы" >> "LDAP подключение", нажмите кнопку "Редактировать".

Настройте параметры подключения:  
 
* Адрес - Адрес сервера ActiveDirectory;
* Порт - Порт для подключения по протоколу LDAP к серверу ActiveDirectory;  
* SSL - Использование Ssl соединения при подключении к ActiveDirectory;
* Таймаут - Время ожидания ответа от сервера ActiveDirectory.

Настройте параметры авторизации:  

* Логин - DistinguishedName системного аккаунта в ActiveDirectory;
* Пароль - Пароль системного аккаунта в ActiveDirectory.

Настройте дополнительные параметры:

* Базовая строка поиска - Базовая строка поиска пользователей в ActiveDirectory (SearchBase); 
* Атрибут для получения логина - Название атрибута пользователя в ActiveDirectory, используемого для авторизации в системе;  
* Атрибут для получения E-mail - Название атрибута пользователя в ActiveDirectory, используемого для определения электронной почты пользователя;
* Атрибут для получения ФИО - Название атрибута пользователя в ActiveDirectory, используемого для определения ФИО пользователя;
* Атрибут для получения структурного подразделения - Название атрибута пользователя в ActiveDirectory, используемого для определения структурного подразделения пользователя;  
* Атрибут для получения группы пользователя - Название атрибута пользователя в ActiveDirectory, используемого для определения групп пользователя.

#### 5.2.3 Создание структурных подразделений

Атрибут "Структурное подразделение" необходим для настройки отправки и получения уведомлений группе пользователей.

**Создание**  

   Для создания структурного подразделения перейдите в раздел "Пользователи" >> "Структурные подразделения".
1. Нажмите кнопу "Добавить".
2. Заполните название и описание структурного подразделения.
3. Нажмите "Создать".  

**Редактирование**

   Для редактирования структурного подразделения перейдите в раздел "Пользователи" >> "Структурные подразделения".

1. Нажмите кнопу "Меню действий", выберите "Редактировать".
2. Измените название и/или описание структурного подразделения.  
3. Нажмите "Сохранить".  

**Удаление**

   Для удаления структурного подразделения перейдите в раздел "Пользователи" >> "Структурные подразделения".

1. Нажмите кнопу "Меню действий", выберите "Удалить".  
2. Подтвердите удаление. 

#### 5.2.4 Создание должности

Атрибут "Должность" служит для удобства администрирования пользователей и не является обязательным элементом в системе. 

Создание, редактирование и удаление "Должности" аналогично элементу "Структурное подразделение".  

#### 5.2.5 Создание роли

Атрибут "Роль" служит для гибкой настройки доступа пользователей к функциональным ресурсам системы.

**Создание**

   Для создания роли перейдите в раздел "Права доступа" >> "Роли".
   
1. Нажмите кнопку "Добавить". 
2. Заполните название, срок действия и описание роли.
3. Нажмите "Создать".  

**Редактирование**

   Для редактирования роли перейдите в раздел "Права доступа" >> "Роли".

1. Выберете необходимую роль и нажмите кнопку "Редактировать".  
2. Измените название, описание и/или срок действия роли.
3. При необходимости заполните "Группы пользователей LDAP".  
4. Нажмите "Сохранить".  

> ***При указании группы пользователей LDAP, права будут предоставлены соответствующей группе, указанной в ActiveDirectory***
> 
> ***Доступ к ресурсам и описание функций ресурсов системы находится в разделе документа "Назначение права доступа"***   

**Удаление**

   Для удаления роли перейдите в раздел "Права доступа" >> "Роли".

1. Перейдите в карточку роли.
2. Нажмите кнопку "Удалить".  
3. Подтвердите удаление. 

#### 5.2.6 Заведение и настройка нового пользователя

Регистрация нового пользователя системы доступна пользователю с ролью "SuperAdmin". 

> ***Возможно создание другой роли с разрешенными правами на ресурсы: "Управление пользователями" и "Права доступа"***   

Для создания учетной записи нового пользователя, без использования LDAP, необходимо зайти в раздел "Пользователи" >> "Список пользователей" и нажать кнопку "Добавить".   

1. В открывшемся окне необходимо заполнить следующие данные:   

   * ФИО;  
   * Логин;  
   * Электронная почта;  
   * Пароль (при первом входе в систему пользователю потребуется сменить пароль на новый)
     * Ручной ввод пароля;
     * Автогенерация пароля. 
   * Срок действия аккаунта; 
   * Подразделение:   
     * по умолчанию используется "Стандартное подразделение", для редактирования или создания нового подразделения перейдите в справочный каталог "Структурные подразделения";
   * Должность:   
     * Должна быть предварительно создана в справочнике "Должности"; 
     * Не является обязательным для заполнения.  
   * Логин в Telegram; 
   * Номер телефона;
   * Описание.

***Требования к паролю пользователя***
>***Длина пароля должна составлять не менее 8 символов***
>
>***Пароль должен состоять из букв латинского алфавита `(A-z)`, арабских цифр `(0-9)` и специальных символов `(. , : ; ? ! * + % - < > @ ][ { } / \ _ {} $ # )`***
>
>***Буквенная часть пароля должна содержать как строчные, так и прописные (заглавные) буквы***

2. Сохранить введенные данные, нажав кнопку "Создать".  
3. Созданная учетная запись будет отображена в разделе "Списки пользователей". 

![Создание учетной записи нового пользователя](./media/EMS_user_guide_files/EMS_user.png "Создание пользователя")

**Включение в центр идентификации пользователей BMC**

Для авторизованного доступа пользователя к BMC оборудованию, необходимо включить его в центр идентификации пользователей BMC.  
   Перейдите в раздел "Пользователи" >> "Список пользователей" и выберите там необходимого, после нажатия ЛКМ откроется карточка пользователя. 
1. Нажмите "Редактировать" и выберите "Включить в центр идентификации пользователей BMC". 
2. Сохраните изменения.  

![Пользователи. Центр идентификации BMC](./media/EMS_user_guide_files/EMS_centr_ident.png "Пользователи.Центр идентификации")

**Удаление и блокировка учетной записи пользователя**

   Для блокировки/разблокировки пользователя перейдите в карточку его учетной записи.  
1. Нажмите "Блокировка пользователя", если учетная запись ранее была заблокирована, то "Разблокировка пользователя".  
2. Подтвердите смену статуса, нажав "Подтвердить".

   Для удаления пользователя из системы перейдите в карточку его учетной записи.  
3. Нажмите "Удалить пользователя".  
4. Подтвердите удаление. 

> **ВАЖНО! Восстановить удаленную учетную запись невозможно**

#### 5.2.7 Назначение прав доступа

Права доступа пользователя зависят от назначенной ему роли. В свою очередь роль зависит от добавленных в нее ресурсных групп.
Для создания группы ресурсов необходимо открыть раздел "Права доступа", перейти в подраздел "Группы ресурсов".
1. Нажмите кнопку "Добавить".  
2. В открывшемся окне заполните название и описание группы ресурсов, после чего нажмите кнопку "Создать".  
Теперь в справочнике отображена созданная группа ресурсов. Нажмите на созданную группу ресурсов, чтобы перейти к ее настройкам. 

В окне настройки выбранной группы ресурсов необходимо определить перечень разрешенных и запрещенных ресурсов, доступ к которым будет предоставлен или ограничен при назначении данной группы на роль. 
1. Нажмите кнопку "Редактировать" в области экрана "Разрешенных/запрещенных ресурсов", отметьте необходимые ресурсы и нажмите кнопку "Сохранить".   

Матрица ресурсов ролевой модели системы отображена в таблице

|	№	|	Ресурс	|	Уровень доступа к ресурсу	|	Значение уровня	|	Описание ресурса	|
|	---	|	---	|	---	|	---	|	---	|
|	1	|	Репозиторий пользовательских инструкций	|	Доступ на чтение	|	Отображение раздела и объектов в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к разделу репозитория с пользовательскими инструкциями	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	2	|	Журнал аудита	|	Уровень доступа отсутствует	|	Отображение раздела в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к журналу аудита системы	|
|	3	|	Управление ОС	|	Уровень доступа отсутствует	|	Отображение раздела в интерфейсе системы + возможность выполнения операции	|	Назначение данного ресурса включает в себя доступ к операциям: Установка ОС и Смена загрузочного носителя	|
|	4	|	Настройка доступа к оборудованию	|	Доступ на чтение	|	Отображение раздела в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к функционалу по настройке доступа пользователя к оборудованию системы 	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	5	|	Управление фоновыми задачами	|	Доступ на чтение	|	Отображение раздела в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к функционалу по настройке фоновых задач	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	6	|	Управление прошивками	|	Уровень доступа отсутствует	|	Отображение раздела в интерфейсе системы + возможность выполнения операции	|	Назначение данного ресурса включает в себя доступ к операциям: Обновление BMC и Обновление BIOS	|
|	7	|	Шаблоны мониторинга оборудования	|	Доступ на чтение	|	Отображение раздела в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к функционалу по настройке шаблонов мониторинга оборудования	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	8	|	Подтверждение задач	|	Доступ на чтение	|	Отображение раздела в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к функционалу по подтверждению задач, требующих согласования	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	9	|	Управление sh/bash/PowerShell	|	Уровень доступа отсутствует	|	Отображение раздела в интерфейсе системы + возможность выполнения операции	|	Назначение данного ресурса включает в себя доступ к операциям: Выполнение sh/bash/PowerShell скриптов и Установка ПО с помощью sh/bash	|
|	10	|	Сертификаты	|	Доступ на чтение	|	Отображение раздела в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к разделу репозитория с сертификатами	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	11	|	Управление энергопотреблением	|	Уровень доступа отсутствует	|	Отображение раздела в интерфейсе системы + возможность выполнения операции	|	Назначение данного ресурса включает в себя доступ к операциям: Установка уровня энергопотребления	|
|	12	|	Управление геораспределённым инстансом	|	Доступ на чтение	|	Отображение раздела в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к управлению геораспределёнными кластерами системы	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	13	|	Карты связей устройств	|	Доступ на чтение	|	Отображение раздела в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к функционалу по работе с картами оборудования	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	14	|	Управление SSO	|	Уровень доступа отсутствует	|	Отображение раздела в интерфейсе системы + возможность выполнения операции	|	Назначение данного ресурса включает в себя доступ к функционалу по определению оборудования в рамках которого можно предоставить доступ к BMC без ввода данных авторизации. В рамках функционала SSO система использует системного пользователя с логином `nerd` и паролем `0penBmc`	|
|	15	|	Системный Репозиторий	|	Доступ на чтение	|	Отображение раздела и объектов в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ ко всем разделам репозитория |
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	16	|	Шаблоны мониторинга сервисов	|	Доступ на чтение	|	Отображение раздела и объектов в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к функционалу по настройке шаблонов и правил мониторинга сервисов	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	17	|	Управление лицензиями	|	Доступ на чтение	|	Отображение раздела и объектов в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к функционалу по работе с лицензиями системы	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	18	|	Настройка расширенных полей устройства	|	Доступ на чтение	|	Отображение раздела и объектов в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к функционалу по настройке дополнительных полей устройства	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	19	|	Управление пользователями	|	Доступ на чтение	|	Отображение раздела и объектов в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к функционалу по управлению пользователями системы: Создание/Удаление/Редактирование/Назначение роли	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	20	|	Управление конфигурациями коммутаторов	|	Уровень доступа отсутствует	|	Отображение раздела в интерфейсе системы + возможность выполнения операции	|	Назначение данного ресурса предоставляет доступ к функционалу по сохранению и загрузке	конфигураций коммутаторов заведенных в систему|
|	21	|	Управление питанием оборудования	|	Уровень доступа отсутствует	|	Отображение раздела в интерфейсе системы + возможность выполнения операции	|	Назначение данного ресурса включает в себя доступ к операциям:  Включение/Выключение/Перезагрузка оборудования	|
|	22	|	Настройка подключения к LDAP серверу	|	Уровень доступа отсутствует	|	Отображение раздела в интерфейсе системы + возможность редактирования данных	|	Назначение данного ресурса включает в себя доступ к функционалу по настройке LDAP  подключения 	|
|	23	|	Настройка подключения к SIEM	|	Уровень доступа отсутствует	|	Отображение раздела в интерфейсе системы + возможность редактирования данных	|	Назначение данного ресурса включает в себя доступ к функционалу по настройке подключения к SIEM	|
|	24	|	Оборудование	|	Доступ на чтение	|	Отображение объектов в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к оборудованию системы: Директория(только чтение)/Сетевые интерфейсы/Модели/Стойки	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	25	|	Справочный каталог оборудования	|	Доступ на чтение	|	Отображение раздела и объектов в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к функционалу по настройке разделов справочного каталога оборудования: Вендор/Модель/Процессор/Группы сопровождения/Здания/Помещения/Тип сервиса/Теги	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	26	|	Права доступа	|	Доступ на чтение	|	Отображение раздела в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к функционалу по настройке Ролей и Групп ресурсов	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	27	|	Уведомления	|	Доступ на чтение	|	Отображение раздела в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к функционалу по настройке уведомлений: Настройка уведомлений Ролей/Пользователей/WebHook/Шаблоны	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	28	|	Настройка подключения к SMTP серверу	|	Уровень доступа отсутствует	|	Отображение раздела в интерфейсе системы + возможность редактирования данных	|	Назначение данного ресурса включает в себя доступ к функционалу по настройке подключения к SMTP серверу	|
|	29	|	Тег	|	Доступ на чтение	|	Отображение раздела и объектов в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к функционалу по настройке тегов оборудования	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	30	|	Дашборд	|	Доступ на чтение	|	Отображение раздела и объектов в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к функционалу дашбордов системы. Отображение на главной странице по умолчанию. Разрешение ресурса предоставляет доступ к переименованию, созданию и удалению	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	31 |	Управление и настройка бэкапов системы	|	Уровень доступа отсутствует	|	Отображение раздела в интерфейсе системы + возможность выполнения резервного копирования	|	Назначение данного ресурса включает в себя доступ к функционалу по настройке подключения к хранилищу, запуск и отмена операции резервного копирования|
|	32	|	Панель диагностики	|	Уровень доступа отсутствует	|	Отображение раздела в интерфейсе системы + возможность использования терминала	|	Назначение данного ресурса включает в себя доступ к функционалу по диагностике состояния устройств с использованием утилит операционной системы Linux через терминал	|
|	33	|	Настройка синхронизации проводника	|	Уровень доступа отсутствует	|	Отображение кнопки включения данной настройки в интерфейсе системы |	Назначение данного ресурса включает в себя доступ к функционалу по синхронизации структуры физического проводника системы в логический	|
|	34	|	Управление директориями логического проводника	|	Доступ на чтение	|	Отображение объектов в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к директориям системы и их вложенности	|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	35	|	Системы	|	Доступ на чтение	|	Отображение объектов в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к сервисам и системам|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|
|	36	|	Обслуживание устройства	|	Доступ на чтение	|	Отображение информации в интерфейсе системы	|	Назначение данного ресурса включает в себя доступ к просмотру, запуску и редактированию режима обслуживания на устройствах|
|		|		|	Доступ на чтение, создание и изменение	|	 + возможность создания и изменения 	|		|
|		|		|	Полный доступ	|	 + возможность удаления	|		|

![Карточка группы ресурсов](./media/EMS_user_guide_files/EMS_resource_group.png "Карточка группы ресурсов")

   Для добавления группы ресурсов к выбранной роли нажмите кнопку "Изменить" в области экрана "Группа добавлена в роли". 
1. Выберите в списке роли, которым нужно добавить группу ресурсов. 
2. Нажмите "Сохранить".  

Группы ресурсов могут быть **наследуемыми**. Наследование настроек доступа роли к ресурсам позволяет получить доступ за счет переиспользования существующих групп ресурсов, в случае если на одну роль требуется добавить более одной группы ресурсов.    
   Для этого в области экрана "Наследуемые группы ресурсов" нажмите кнопку "Изменить". 
1. В открывшемся списке групп ресурсов выберите группу, ресурсы которой необходимо наследовать. 
2. Нажмите кнопку "Сохранить".   

>**ВАЖНО!** ***Запрещенные ресурсы не будут доступны в наследуемых группах***

Далее перейдите в раздел "Права доступа", подраздел "Роли". Откройте карточку роли, для которой вы добавили группу ресурсов.   
Информация о добавленных группах ресурсов будет показана на вкладке "Настройка доступа".   

![Настройка доступа к ресурсам](./media/EMS_user_guide_files/EMS_resource.png "Настройка доступа к ресурсам")

   Отредактируйте доступ к разрешенным ресурсам роли. Для этого нажмите кнопку "Редактировать" в области экрана "Доступ к ресурсам".   
1. Выберите ресурс и назначьте уровень доступа из списка:  

* Доступ на чтение;  
* Доступ на чтение, создание и удаление;
* Полный доступ. 

>**ВАЖНО!** ***Часть ресурсов не имеет уровня доступа. Выбор данного ресурса предоставит доступ всем пользователям с назначенной ролью***

2. Подтвердите изменения уровня доступа нажав на кнопку "Сохранить". 

#### 5.2.8 Назначение доступов к оборудованию

   Для возможности просмотра и управления заведенными в систему ОМиУ пользователю необходимы права доступа к оборудованию.   
1. Перейдите в раздел "Права доступа" в подраздел "Доступы к оборудованию".   
2. В дереве проводника выберите кластер или директорию кластера к которому нужно предоставить доступ. 
3. Нажмите кнопку выбора пользователей и в открывшемся окне "Списка доступных пользователей" выберите пользователей для предоставления доступа и нажмите кнопку "Добавить". 
4. На экране отобразится информация о списке пользователей с выданным доступом выбранному объекту.  

> **ВАЖНО!**  ***Доступ можно выдать как на весь кластер, так и на отдельную директорию. Пользователь с правами на выбранную директорию получит права ко всем вложенным директориям.***   

   Для отмены доступа к выбранной директории нажмите кнопку выбора пользователей.
1. В открывшемся окне "Списка доступных пользователей" отметьте пользователей. 
2. Нажмите кнопку "Удалить".  

![Доступы к оборудованию](./media/EMS_user_guide_files/EMS_dostup_k_oborud.png "Доступы к оборудованию")

#### 5.2.9 Аудит пользователей

Для просмотра действий пользователей системы требуется перейти в раздел "Пользователи" >> "Журнал аудита".  
В данном подразделе представлена историческая информация о всех действиях, которые совершил пользователь.  
1. Для просмотра лога аудита события можно развернуть выбранное событие. 
2. Для поиска, фильтрации и сортировки записей в журнале используйте поисковую строку в верхней части экрана. Доступны следующие поля фильтрации: 

   * Логин;
   * ФИО;
   * Событие;
   * IP Адрес;
   * Подразделение;
   * Должность;
   * Время;
   * Описание.

![Журнал аудита](./media/EMS_user_guide_files/EMS_audit.png "Журнал аудита")

#### 5.2.10 Управление задачами 

**Фоновые задачи мониторинга**

 Функционал отвечает за настройку выполнения задач по сбору данных с ОМиУ заведенных в систему

В разделе "Задачи" >> "Фоновые задачи" можно настроить интервалы времени опроса обслуживаемых ОМиУ.
В данном разделе содержатся сгруппированные по своему типу, задачи мониторинга которые выполняются в фоновом режиме и информация о них:

* Название задачи мониторинга;
* Время предыдущего запуска;
* Время следующего запуска;
* Интервал запуска;
* Статус задачи.

![Фоновые задачи](./media/EMS_user_guide_files/EMS_fon.png "Фоновые задачи")

Для изменения интервала выбранной задачи введите новое значение в формате чч:мм и нажмите кнопку "Сохранить".
Для смены статуса активности выбранной задачи нажмите на иконку статуса для смены (активно/приостановлено).

Список доступных фоновых задач следующий:
* Получение данных CPU с помощью Linux;
* Получение данных использования CPU с помощью Linux;
* Получение данных RAM с помощью гипевизора;
* Получение данных pci слотов с помощью BMC;
* Получение данных операционной системы хоста с помощью BMC;
* Получение данных pci слотов с помощью гипевизора;
* Получение данных версий прошивок firmware с помощью BMC;
* Получение данных состояния LED с помощью BMC;
* Проверка доступности сетевых интерфейсов по Icmp протоколу;
* Проверка доступности сетевых интерфейсов BMC;
* Получение данных RAM с помощью BMC;
* Получение данных текущего времени работы устройства с помощью Linux;
* Получение данных источника загрузки BIOS с помощью BMC;
* Получение данных использования RAM с помощью Linux;
* Получение данных использования CPU с помощью BMC;
* Получение данных операционной системы хоста с помощью Windows;
* Получение данных pci слотов с помощью Linux;
* Получение данных ограничения максимального энергопотребления с помощью BMC;
* Получение данных текущего времени работы устройства с помощью гипевизора;
* Получение health-статуса BMC;
* Получение данных операционной системы хоста с помощью Linux;
* Получение данных дисков с помощью Linux;
* Получение данных текущего загрузочного носителя с помощью BMC;
* Получение данных дисков с помощью BMC;
* Получение данных текущего энергопотребления с помощью шаблонов SNMP;
* Получение данных CPU с помощью гипевизора;
* Получение данных инвентарной информации с помощью шаблонов SNMP;
* Получение данных статуса питания хоста с помощью BMC;
* Получение данных виртуальных машин с помощью гипевизора;
* Получение данных текущего температуры устройства с помощью шаблонов SNMP;
* Получение статуса вхождения оборудования в центр SSO;
* Получение данных операционной системы хоста с помощью гипевизора;
* Получение данных текущего времени работы устройства с помощью Windows;
* Проверка доступности сетевых интерфейсов SNMP;
* Получение данных использования RAM с помощью Windows;
* Получение данных дисков с помощью гипевизора;
* Получение данных pci слотов с помощью Windows;
* Получение данных сенсоров BMC;
* Получение логов устройства с помощью BMC;
* Получение данных инвентарной информации с помощью BMC;
* Проверка доступности сетевых интерфейсов Linux;
* Проверка доступности сетевых интерфейсов Windows;
* Получение данных текущего температуры устройства с помощью BMC;
* Получение статуса сервисов;
* Получение данных гипевизора;
* Получение данных RAM с помощью Windows;
* Получение данных CPU с помощью BMC;
* Получение данных дисков с помощью Windows;
* Получение списка виртуальных машин гипевизора;
* Получение данных использования RAM с помощью гипевизора;
* Получение данных CPU с помощью Windows;
* Получение данных сенсоров шаблонов SNMP;
* Получение данных RAM с помощью Linux;
* Получение данных использования CPU с помощью Windows;
* Проверка доступности сетевых интерфейсов гипевизора;
* Получение данных использования CPU с помощью гипевизора;
* Получение данных использования RAM с помощью BMC;
* Получение данных текущего энергопотребления с помощью BMC;
* Получение данных операционной системы хоста с помощью шаблонов SNMP.

**Запланированные задачи**

Для операций, выполняемых на оборудовании, можно настроить параметры запуска и выполнения. 
Запуск операции может быть выполнен сразу или запланирован в будущем. Также задачи могут быть настроены на запуск по расписанию. 

![Настройка времени запуска операций](./media/EMS_user_guide_files/EMS_device_operation.png "Настройка времени запуска операций")

   Планирование отложенного запуска по времени можно настроить после выбора протокола для выбранной операции. 
1. Укажите наименование планируемой операции и нажмите на кнопку "По времени".
2. В открывшейся вкладке укажите время запуска и выберите дату планового запуска операции. 
3. Выберите оборудование и конфигураций. 
4. Нажмите кнопку "Запустить по расписанию". 

   Планирование запуска по расписанию можно настроить после выбора протокола для выбранной операции.
5. Укажите наименование планируемой операции и нажмите на кнопку "По расписанию". 
6. В открывшейся вкладке выберите тип планируемого запуска: 
   
   * По интервалу. Укажите время начала выполнения, интервал выполнения и параметр завершения выполнения операции. 
   * По периоду. Укажите время начала выполнения, период выполнения по дню недели и времени и параметр завершения выполнения операции. 
   * CRON. Укажите параметры выполнения операции в CRON формате.
   
> ***Параметры CRON указываются с учетом библиотеки Quartz***
> ***Примеры параметров запуска:***   
> 
> ***0 0 12 * * ?	- Запускать в 12 часов дня каждый день***   
>
> ***0 0/5 14,18 * * ? - Запускать каждые 5 минут, начиная с 14:00 и заканчивая в 14:55 и запускать каждые 5 минут, начиная с 18:00 и заканчивая 18:55, каждый день*** 
>
> ***0 15 10 ? * 6L - Запускать в 10:15 утра в последнюю пятницу каждого месяца***   

7. Выберите оборудование и конфигураций. 
8. Нажмите кнопку "Запустить по расписанию". 

Перейдите в раздел "Задачи" >> "Запланированные задачи". В данном разделе показаны все запланированные операции на будущий период.

![Запланированные задачи](./media/EMS_user_guide_files/EMS_plan_task.png "Запланированные задачи")

Пользователю доступны просмотр информации о запланированных операциях, отмена операции, принудительный запуск, остановка и перепланирование параметров запуска. 
Действия по принудительному запуску, остановке и удалению запланированных задач можно выполнить как для единичной операции, так и для группы.

**Задачи ожидающие подтверждения**

Операции с оборудованием, имеющим защищенный уровень доступа, требуют подтверждения администратором или пользователем, с разрешенным ресурсом "Подтверждение задач". Уровень доступа к оборудованию определяется назначенным тегом устройства.

> ***Описание процедуры по созданию и назначению тега на устройство находится в разделе [Теги](####Теги)***   

В разделе "Задачи, ожидающие подтверждения" отображаются все операции с оборудованием отправленные пользователями для подтверждения.

Подтвердить или отменить выполнение можно как для единичной операции, так и для группы.

![Задачи ожидающие подтверждения](./media/EMS_user_guide_files/EMS_approve_task.png "Задачи ожидающие подтверждения")

#### 5.2.11 Наполнение справочных каталогов объектов системы

Справочные каталоги отвечают за хранение и учет инфраструктурных элементов, которые могут быть использованы для настройки и определения процессов управления, а также мониторинга устройств, заведенных в систему.

В EMS представлены следующие каталоги объектов системы:

**Операционные системы**

Каталог содержит в себе справочную информацию об операционных системах используемого оборудования.
Для создания в каталоге нового элемента нажмите кнопку "Добавить".
1. В окне создания заполните название операционной системы. При необходимости заполните поле "Описание".
2. Нажмите кнопку "Создать". Новый элемент сохранится в каталоге.

Для просмотра справочной информации и редактирования элемента каталога кликните по интересующей ОС.
В карточке ОС отображается список добавленного оборудования использующего выбранную ОС.
При нажатии на оборудование будет выполнен переход к карточке выбранного устройства.

**Типы оборудования**

Каталог содержит в себе справочную информацию о типах используемого оборудования.
Для создания в каталоге нового элемента нажмите кнопку "Добавить".
1. В окне создания заполните название типа оборудования. При необходимости заполните поле "Описание".
2. Нажмите кнопку "Создать". Новый элемент сохранится в каталоге.

Для просмотра справочной информации и редактирования элемента каталога кликните по интересующему типу оборудования.
В карточке типа оборудования отображаются списки шаблонов мониторинга, которые применяются к данному типу. также показаны модели оборудования, добавленные к выбранному типу оборудования.
При нажатии на шаблон мониторинга или модель будет выполнен переход к карточке выбранного элемента.
Для привязки типа оборудования к модели нажмите кнопку "Добавить", отметьте необходимые модели и нажмите на кнопку "Сохранить".

**Производители оборудования**

Каталог содержит в себе справочную информацию о производителях используемого оборудования.
Для создания в каталоге нового элемента нажмите кнопку "Добавить".
1. В окне создания заполните название производителя оборудования. При необходимости заполните поле "Описание".
2. Нажмите кнопку "Создать". Новый элемент сохранится в каталоге.

Для просмотра справочной информации и редактирования элемента каталога кликните по интересующему производителю.
В карточке производителя оборудования показаны модели оборудования, добавленные к выбранному производителю.
При нажатии на модель будет выполнен переход к карточке выбранного элемента.
Для привязки производителя оборудования к модели нажмите кнопку "Добавить", отметьте необходимые модели и нажмите на кнопку "Сохранить"

**Модели оборудования**

Каталог содержит в себе справочную информацию о моделях используемого оборудования.
Для создания в каталоге нового элемента нажмите кнопку "Добавить".
1. В окне создания заполните название производителя оборудования. При необходимости заполните поле "Описание";
2. Выберите из списков тип и производителя оборудования. Эти поля являются обязательными для заполнения;
3. Выберите из списка процессор (необязательно);
4. Выберите тип обдува данной модели оборудования;
5. Выберите тип крепления модели в серверной стойке;
6. Укажите высоту модели в юнитах;
7. Укажите ширину модели относительно ее размещения в серверной стойке;
8. Укажите глубину модели относительно ее размещения в серверной стойке;
9. Нажмите кнопку "Создать". Новый элемент сохранится в каталоге.

> ***ВАЖНО! Процессор, тип и производитель оборудования должны быть созданы предварительно***

Для просмотра справочной информации и редактирования элемента каталога выберите нужную модель оборудования.
В карточке модели оборудования показаны шаблоны мониторинга и оборудование, добавленные к выбранной модели.
При нажатии на шаблон мониторинга или оборудование будет выполнен переход к карточке выбранного элемента.

**Процессоры**

Каталог содержит в себе справочную информацию о процессорах используемого оборудования.
Для создания в каталоге нового элемента нажмите кнопку "Добавить".
1. В окне создания заполните название процессора оборудования. При необходимости заполните поле "Описание";
2. Нажмите кнопку "Создать". Новый элемент сохранится в каталоге.

Для просмотра справочной информации и редактирования элемента каталога кликните по интересующему процессору.
В карточке процессора показаны шаблоны мониторинга и модели оборудование, добавленные к выбранному процессору.
При нажатии на шаблон мониторинга или модель оборудования будет выполнен переход к карточке выбранного элемента.
Для привязки процессора к модели оборудования нажмите кнопку "Добавить", отметьте необходимые модели и нажмите на кнопку "Сохранить".

**Группы сопровождения**

Каталог содержит в себе справочную информацию о группах сопровождения, добавленных в систему. 
Для создания в каталоге нового элемента нажмите кнопку "Добавить".
1. В окне создания заполните название нового элемента группы;
2. При необходимости заполните поле "Описание". Нажмите кнопку "Создать". Новый элемент сохранится в каталоге.

Для просмотра справочной информации и редактирования элемента каталога кликните по интересующей группе сопровождения. 
В карточке показан список стоек. При нажатии на стойку будет выполнен переход к карточке выбранного элемента. 
Добавьте стойку в группу сопровождения, нажав на кнопку "Изменить", отметьте необходимые стойки и нажмите на кнопку "Сохранить". 

> **ВАЖНО!** ***При выборе группы сопровождения по умолчанию, данная настройка будет применена ко всем стойкам, у которых не назначена группа*** 

**Здания**

Каталог содержит в себе справочную информацию о зданиях, добавленных в систему. 
Для создания в каталоге нового элемента нажмите кнопку "Добавить".
1. В окне создания заполните название нового элемента помещения. При необходимости заполните поле "Описание";
2. Нажмите кнопку "Создать". Новый элемент сохранится в каталоге.

Для просмотра справочной информации и редактирования элемента каталога кликните по интересующему зданию. 
В карточке здания показан список помещений. При нажатии на помещение будет выполнен переход к карточке выбранного элемента. 
Добавьте помещение в здание, нажав на кнопку "Изменить", отметьте необходимые помещения и нажмите на кнопку "Сохранить". 

> ***Здание является объектом физического проводника системы и может быть создано в интерфейсе "Проводник", вид - "Физический"*** 

**Помещения**

Каталог содержит в себе справочную информацию о помещениях, добавленных в систему.
Для создания в каталоге нового элемента нажмите кнопку "Добавить".
1. В окне создания заполните название нового элемента помещения. При необходимости заполните поле "Описание";
2. Нажмите кнопку "Создать". Новый элемент сохранится в каталоге.

Для просмотра справочной информации и редактирования элемента каталога кликните по интересующему помещению.
В карточке помещения показаны список оборудования и стойки.
При клике элемент стойки или оборудования будет выполнен переход к карточке выбранного элемента.
Добавьте стойки в помещение, нажав на кнопку "Изменить", отметьте необходимые стойки и нажмите на кнопку "Сохранить".
Добавьте оборудование в помещение, нажав на кнопку "Добавить", выберите нужные и нажмите "Сохранить"

> ***Помещение является объектом физического проводника системы и может быть создано в интерфейсе "Проводник", вид - "Физический"*** 

**Типы сервисов**

Каталог содержит в себе справочную информацию о типах сервисов добавленных в систему.
Для создания в каталоге нового элемента нажмите кнопку "Добавить".
1. В окне создания заполните название типа сервиса. При необходимости заполните поле "Описание";
2. Нажмите кнопку "Создать". Новый элемент сохранится в каталоге.

Для просмотра справочной информации и редактирования элемента каталога кликните по интересующему типу сервисов.
В карточке типа сервисов показаны используемые шаблоны мониторинга сервисов. А также список сервисов системы с данным типом.
При клике на шаблон мониторинга будет выполнен переход к карточке выбранного элемента.
Для привязки типа сервиса к шаблону мониторинга сервисов нажмите кнопку "Изменить", отметьте необходимые шаблоны и нажмите на кнопку "Сохранить".

**Теги**

Каталог содержит в себе справочную информацию о тегах, с помощью которых настраивается уровень доступа к выполнению операций на оборудовании.
Для создания в каталоге нового элемента нажмите кнопку "Добавить".
1. В окне создания заполните название тега. При необходимости заполните поле "Описание";
2. Выберите цвет тега. Цвет можно указать в форматах HEX или RGB;
3. Выберите тип уровня доступа:

   * Без ограничений;
   * Требуется согласование;
   * Требуется подтверждение (CAPTCHA).

4. Нажмите кнопку "Создать". Новый элемент сохранится в каталоге.

Для просмотра справочной информации и редактировании элемента каталога кликните по интересующему тегу.
В карточке тега показаны шаблоны мониторинга сервисов и устройства, к которым применен данный тег.
Для добавления/удаления тега в шаблон мониторинга сервисов нажмите кнопку "Изменить". В открывшемся окне отметьте шаблоны, в которых будет использоваться выбранный тег. Нажмите "Сохранить".
Для добавления тега к устройству на жмите кнопку "Добавить". Далее выберите в директории проводника одно или несколько устройств (поставив отметку в чекбоксе) и нажмите "Продолжить". Изменения сохранятся и будут отображены в карточке тега.
Для удаления отметьте устройства и нажмите кнопку "Удалить".

> ***При наличии сооветствующих прав у пользователя теги можно добавлять или убирать из карточки выбранного устройства, в разделе его общей информации***

#### 5.2.12 Работа с репозиториями системы

Репозиторий системы отвечает за хранение и учет файлов, которые могут быть использованы для управления и мониторинга оборудования устройств, подключенных к системе.

В EMS представлены следующие репозитории данных:

* Прошивки BMC;
* Прошивки BIOS/UEFI;
* Конфигурации коммутаторов;
* ISO образы;
* Kickstart/Preseed файлы;
* MIB файлы;
* Конфигурации Zabbix;
* Cкрипты;
* Сертификаты;
* Образы ПО;
* Инструкции пользователей.

**Добавление файлов**

Для добавления файла перейдите в раздел системы "Репозиторий". Выберите нужный раздел и нажмите кнопку "Добавить".
1. В открывшемся окне нажмите "Добавить" и выберите в проводнике необходимы файл и нажмите "Открыть".
2. Заполните предложенные поля ввода метаданных.
3. Нажмите кнопку "Загрузить".
Файл загружен в систему и отображается в списке выбранного репозитория.

**Создание файлов**

В EMS возможно вручную создать следующие типы файлов:

* Конфигурации коммутаторов;
* Kickstart/Preseed файлы;
* MIB файлы;
* Конфигурации Zabbix;
* Скрипты;
* Инструкции пользователей.

Перейдите в необходимы репозиторий и нажмите кнопку "Добавить".
1. В открывшемся окне нажмите "Создание файла".
2. Укажите название файла.
3. Внесите необходимую информацию в текстовое поле.
4. Заполните оставшиеся метаданные файла, такие как IP адрес устройства, операционная система, производитель.

**Редактирование файлов**

В EMS возможно редактирование добавленных в репозиторий файлов. Типы файлов доступные для редактирования:

* Конфигурации коммутаторов;
* Kickstart/Preseed файлы;
* MIB файлы;
* Конфигурации Zabbix;
* Скрипты;
* Инструкции пользователей.

Для редактирования кликните по названию файла и нажмите "Редактирование файла".
Внесите необходимые изменения и нажмите "Обновить".

**Скачивание файлов репозитория**

Любой файл репозитория можно скачать. Для этого перейдите в нужный репозиторий отметьте чекбоксы необходимых файлов и нажмите кнопку "Скачать".
Скачанные файлы сохранятся на ваше устройство в папку по умолчанию указанную в настройках браузера.

**Удаление файлов репозитория**

Для удаления перейдите в нужный репозиторий, отметьте чекбоксы необходимых файлов и нажмите кнопку "Удалить".
В открывшемся окне подтвердите действие.

#### 5.2.13 Резервное копирование 

Создание резервных копий системы предусматривает два способа: 

* Ручное резервное копирование; 
* Создание резервных копий по расписанию. 

Предварительно необходимо настроить подключение к NFS хранилищу. 
Для это откройте раздел "Настройки системы" и выберите вкладку "Резервное копирование"
1. Нажмите кнопку "Изменить".
2. Укажите параметры подключения к хранилищу: 
   * Username;
   * Uid;
   * Gid;
   * Адрес хранилища;
   * Путь монтирования.
3. Нажмите кнопку "Сохранить" 

> ***Проверка доступности хранилища и свободное пространство проверяется системой автоматически*** 

Для выполнения ручного резервного копирования нажмите кнопку "Запустить вручную". Система запустит процедуру резервного копирования. 

> ***При необходимости можно выполнить отмену запущенной процедуры*** 

Для выполнения резервного копирования по расписанию: 
1. Нажмите кнопку "Настроить".
2. Выберите день недели и время выполнения операции. 
3. Нажмите кнопку "Сохранить".

> ***Каждая операция резервного копирования фиксируется в данном интерфейсе и журнале аудита пользователей системы*** 
>
> ***Для обеспечения консистентности копируемых данных, рекомендуется проводить резервное копирование вне периода работ по созданию или обновлению объектов в системе***

#### 5.2.14 Пользовательские протоколы подключения

> ***Инструкция по добавлению пользовательских протоколов подключения к устройствам находится в документации по работе с модулями расширения системы - EMS SDK*** 

После создания собственного модуля расширения с поддержкой нового протокола подключения к устройствам в системе, необходимо перейти в раздел "Настройка системы" и открыть вкладку "Пользовательские протоколы".
Для добавления нового протокола в интерфейс системы и дальнейшего его использования при обнаружении и мониторинге устройств выполните следующие действия:
1. Нажмите на кнопку "Добавить протокол";
2. Укажите наименование и описание добавляемого протокола;
3. Выберите корректный модуль для данного протокола и нажмите "Сохранить". Учитывайте, что выбранный модуль должен соответствовать реализации расширения системы для поддержки пользовательского протокола. 

> ***Модули системы имеют определенный функционал в части мониторинга и управления, но данный может быть расширен реализацией SDK*** 

![Пользовательские протоколы. Создание](./media/EMS_user_guide_files/EMS_custom_protocol.png "Пользовательские протоколы. Создание")

После добавления пользовательских протоколов в систему EMS, они будут доступны для выбора при обнаружении устройств и в настройках сетей выбранного устройства.  

![Пользовательские протоколы. Устройства](./media/EMS_user_guide_files/EMS_custom_protocol_explore.png "Пользовательские протоколы. Устройства")

А также в шаблонах мониторинга устройств. 

![Пользовательские протоколы. Шаблон мониторинга устройств](./media/EMS_user_guide_files/EMS_custom_protocol_template.png "Пользовательские протоколы. Шаблон мониторинга устройств")

> ***Следует учитывать, что сбор системных метрик по пользовательскому протоколу, настраивается отдельно для каждой метрики*** 

### 5.3 Управление размещением инфраструктуры

#### 5.3.1 Работа с кластерами системы

> ***Добавление нового кластера системы описано в "Руководстве по инсталляции"*** 

#### 5.3.2 Диагностика кластеров системы 

Информация по текущему состоянию компонентов кластера системы, утилизация ресурсов, консоль диагностики и карта агентов доступны в свойствах кластера.   
1. Для их просмотра перейдите в раздел "Проводник".   
2. Нажмите кнопку вызова "Меню действий" (Action menu) выбранного кластера.  
3. Выберите пункт меню "Диагностика".

![Диагностика кластера](./media/EMS_user_guide_files/EMS_cluster_setting.png "Диагностика кластера")

##### Сервисы

На вкладке "Сервисы" показаны статусы состояния каждого компонента кластера системы.    
Нажмите кнопку "Обновить" для обновления данных и получения актуальных статусов сервисов кластера.  

##### Агенты

Вкладка "Агенты" отображает состояние доступных сетевых агентов мониторинга установленных на ОМиУ заведенных в систему, а также позволяет установить нового агента.

##### Консоль диагностики 

Вкладка "Консоль диагностики" представляет собой терминал, временно развернутого контейнера с образом ОС, для проведения диагностики устройств выбранного кластера посредством интегрированных утилит.  

Доступные утилиты: 
* ping;
* tracert;
* nslookup;
* curl;
* snmp;
* ipmitool;
* telnet;
* tcpdump;
* ssh client.

#### 5.3.3 Дашборд кластера

Формирование дашбора с данными мониторинга по устройствам выбранного кластера доступна в его свойствах.   
1. Для формирования дашборда перейдите в раздел "Проводник".   
2. Нажмите кнопку вызова "Меню действий" (Action menu) выбранного кластера.  
3. Выберите пункт меню "Дашборд";
4. Будет открыт дашборд с информацией по устройствам выбранного кластера.

#### 5.3.4 Подсети кластера

Информация по маскам подсетей и событиям сетей доступна в свойствах кластера.   
1. Для их просмотра перейдите в раздел "Проводник".   
2. Нажмите кнопку вызова "Меню действий" (Action menu) выбранного кластера.  
3. Выберите пункт меню "Маски".

![Подсети кластера](./media/EMS_user_guide_files/EMS_cluster_network.png "Подсети кластера")

##### Маски подсети

Вкладка "Маски подсети" отображает список добавленных масок подсети выбранного кластера и список автоматически обнаруженных IP и MAC адресов устройств и справочная информация о них
Маски доступны для просмотра информации и редактирования и быстрого перехода на экран обнаружения и дальнейшего заведения устройств в систему, нажав на кнопку "Перейти в режим заведения".   
Для добавления новой маски нажмите "Добавить" и укажите адреса для добавления.  

##### События сетей

Вкладка "События сетей" отображает список автоматически обнаруженных IP и MAC адресов устройств и справочная информация о них.  
Из записи события можно быстро перейти на экран обнаружения и дальнейшего заведения устройств в систему, нажав на кнопку "Поиск".  

### 5.4 Настройка отображения инфраструктуры

Инфраструктура заведенная или созданная в системе может быть представлена в виде логического или физического проводника.  

Система предоставляет возможность автоматической, односторонней синхронизации логического проводника с создаваемой структурой физического проводника. Для этого необходимо, в рамках пользовательской роли, предоставить доступ к ресурсу "Настройка синхронизации проводника" и включить данную функцию в проводнике системы. Включение данной функции осуществляется нажатием ПКМ по виду отображения структуры проводника. 

![Синхронизация логического проводника системы с физическим](./media/EMS_user_guide_files/EMS_logical_view_synk.png "Синхронизация логического проводника системы с физическим")

> ***Синхронизация логического проводника с физическим будет произведена только по структуре, созданной после включения данной функции***
>
> ***Изменения производимые в структуре логического проводника, не затрагивают физическую структуру***
>
> ***Для обеспечения целостности данных, сначала необходимо создавать объекты "Здание" и "Помещение" в физической структуре проводника, а после создать объект "Стойка" в автоматически созданной структуре логическом проводника***

#### Логический проводник системы

Логический проводник системы является пользовательской настройкой отображения инфраструктуры. Включает в себя отображение следующих объектов: 

* Директории;  
* Серверные стойки; 
* Оборудование;  
* Системы. 

![Логический проводник системы](./media/EMS_user_guide_files/EMS_logical_view.png "Логический проводник системы")

В рамках логического проводника системы, вложенность объектов инфраструктуры может быть отображена в виде древовидной структуры кластеров и директорий. 

![Дерево размещения оборудования в логическом проводнике](./media/EMS_user_guide_files/EMS_logical_view_tree.png "Дерево размещения оборудования в логическом проводнике")

> ***Оборудование будет отображено в структуре дерева, только в случае наличия у пользователя прав доступа к данному оборудованию***

В логическом проводнике системы существует возможность настройки отображаемых полей. 
Список доступных для отображения полей включает в себя: 

* Хостнейм;
* Производитель;
* Модель;
* Стойка;
* Сетевые интерфейсы;
* Статус сетей;
* Статус питания;
* Статус BMC;
* Статус сенсоров;
* Статус гипервизора;
* Сервисы;
* Температура.

Для выбора отображаемых полей проводника, нажмите кнопку "Настройка таблицы" и выберите требуемые поля. 

#### Физический проводник системы

Физический проводник системы является пользовательской настройкой отображения инфраструктуры. Включает в себя отображение следующих объектов: 

* Здания;  
* Помещения; 
* Серверные стойки; 
* Распределенное оборудование; 
* Нераспределенное оборудование.  

![Физический проводник системы](./media/EMS_user_guide_files/EMS_phys_view.png "Физический проводник системы")

В рамках физического проводника системы, вложенность объектов инфраструктуры может быть отображена в виде древовидной структуры зданий, помещений и серверных стоек. 

![Дерево размещения оборудования в физическом проводнике](./media/EMS_user_guide_files/EMS_phys_view_tree.png "Дерево размещения оборудования в физическом проводнике")

> ***Оборудование будет отображено в структуре дерева, только в случае наличия у пользователя прав доступа к данному оборудованию***

В физическом проводнике системы существует возможность настройки отображаемых полей. 
Список доступных для отображения полей включает в себя: 

* Описание; 
* Модель; 
* Производитель; 
* Сетевые интерфейсы; 
* Хостнейм; 
* Юниты; 
* Стойка; 
* Помещение; 
* Здание; 
* Статус сетей; 
* Статус SSO; 
* Статус сенсоров; 
* Статус питания; 
* Статус BMC; 
* Статус гипервизора; 
* Температура; 
* Энергопотребление.

Для выбора отображаемых полей проводника, нажмите кнопку "Настройка таблицы" и выберите требуемые поля. 

> ***В системе реализовано хранение пользовательских настроек отображения выбранных полей***

#### 5.4.1 Создание и удаление директорий

Директория является логической группировкой объектов инфраструктуры и включает в себя: 

* Стойки;
* Оборудование;
* Системы;
* Поддиректории.
  
Заведение и создание объектов происходит на уровне директории. 

В разделе "Проводник" выберите целевой кластер, в котором необходимо создать директорию.  
1. Нажмите кнопку "Добавить".  
2. Укажите название будущей директории и нажмите "Создать".  

Для редактирования директории нажмите на "Меню действий" и выберите "Свойства". 

Для удаления директории нажмите на "Меню действий" карточки директории и выберите "Удалить".  
Для смены директории объекта, нажмите на "Меню действий" целевого объекта и выберите "Переместить в", определите директорию в которую нужно переместить объект и нажмите кнопку "Подтвердить".

> **ВАЖНО!** ***Нельзя удалить директорию, в которой есть контент*** 

#### 5.4.2 Создание и удаление стоек оборудования

Для создания стойки перейдите в директорию кластера и нажмите кнопку "Добавить".  
Выберите пункт меню "Создать стойку". 

> **ВАЖНО!** ***Ручное создание серверной стойки осуществляется в логическом виде проводника системы*** 

![Директория. Меню создания](./media/EMS_user_guide_files/EMS_action_menu.png "Меню создания")

В открывшемся окне создания заполните следующие поля: 
* Наименование создаваемой стойки;
* Описание;
* Серийный номер;
* Помещение в котором размещена данная стойка (выбор осуществляется из существующих помещений созданных в справочном каталоге системы); 
* Ширина стойки (OCP - 21 дюйм или Standart - 19 дюймов);
* Высота стойки (от 1 до 48 юнитов). 

Выберите шаблон создаваемой стойки для более удобной работы с конфигурациями шасси в юнитах. Далее нажмите "Создать стойку". 

> **ВАЖНО!** ***Параметр "Группа сопровождения" будет назначен автоматически, в случае использования свойства "По умолчанию" у выбранной группы в справочном каталоге*** 

![Стойка. Меню создания](./media/EMS_user_guide_files/EMS_rack_crea.png "Создание стойки оборудования")

Для изменения конфигурации, откройте карточку созданной стойки и перейдите во вкладку "Юниты".
В случае, если необходимо изменить шасси для одного или нескольких юнитов стойки, выберите объекты нажав на юниты отображаемой стойки и назначьте новую конфигурацию выбранных юнитов для размещения оборудования соответствующих габаритов. 

![Стойка. Конфигурирование](./media/EMS_user_guide_files/EMS_rack_config.png "Изменение конфигурации стойки")

Система позволяет произвести бронирование юнитов выбранной стойки в случае, если оборудование будет добавлено позже. Для этого выберите юниты, которые необходимо забронировать. В открывшемся окне укажите наименование создаваемой брони и описание, а также укажите дату окончания бронирования. 

> **ВАЖНО!** ***По итогу истечении времени, бронирование будет снято автоматически***
> ***При необходимости время бронирование может быть изменено в настройках бронирования***  
> ***В случае, если бронирование больше не требуется, оно может быть снято вручную в настройках бронирования***  

Для добавления оборудования в стойку перейдите во вкладку "Оборудование".
Может быть добавлены два типа оборудования: 
* С возможностью размещения в юните стойки;
* Без возможности размещения в юните (коммутаторы/роутеры/PDU и т.п.).
Нажмите на кнопку "Добавить оборудование". В открывшемся окне проводника выберите требуемое оборудование и нажмите "Добавить". добавлено оборудование будет отображено рядом со стойкой. Далее необходимо разместить добавленное оборудование в юниты стойки. Для этого переместите добавленное оборудование в нужную ячейку. 

![Стойка. Оборудование](./media/EMS_user_guide_files/EMS_rack_add_device.png "Добавление оборудования в стойку")

> **ВАЖНО!** ***Система автоматически определяет габариты оборудования и размеры юнита при добавлении. В случае их несовпадения, оборудование не будет добавлено в юнит. Габариты оборудования назначаются в справочном каталоге, раздел "Модели оборудования"***
> 
> ***Для извлечения оборудования из юнита, необходимо нажать на него ПКМ и выбрать пункт "Извлечь"***  
> 
> ***Изменение юнита добавленного оборудования осуществляется переносом объекта в другой юнит***  
> 
> ***Для удаления оборудования из стойки, необходимо нажать на него ПКМ и выбрать пункт "Удалить***  

#### 5.4.3 Настройка отображения тепловой карты стойки с оборудованием

Для просмотра данных по температуре оборудования в серверной стойке нажмите на кнопку "Температура", чтобы переключить вид отображения.

При переключении отображения вида в температурный режим, будут доступны графики показателей температуры. Данные по температуре можно просматривать за следующие периоды: 

* 1 день;
* 1 неделю; 
* 1 месяц.

![Стойка. Температура оборудования](./media/EMS_user_guide_files/EMS_rack_temp.png "Стойка. Температура оборудования")

> **ВАЖНО!** ***Система автоматически обнаруживает температурные сенсоры оборудования по протоколам IPMI и Redfish. В случае необходимости можно выбрать требуемые сенсоры в ручном режиме. Настройка осуществляется в разделе "Шаблоны мониторинга", где нужно выбрать используемый шаблон мониторинга и добавить сенсоры по требуемым протоколам на вкладке "Системные метрики"***

#### 5.4.4 Настройка отображения потребления электропитания оборудованием в стойки

Для просмотра данных по энергопотреблению оборудования в серверной стойке нажмите на кнопку "Электропитание", чтобы переключить вид отображения.

При переключении отображения вида в режим энергопотребления, будут доступны графики показателей электропитания. Данные можно просматривать за следующие периоды: 

* 1 день;
* 1 неделю; 
* 1 месяц.

![Стойка. Электропитание оборудования](./media/EMS_user_guide_files/EMS_rack_elec.png "Стойка. Электропитание оборудования")

За формирование представления фактической структуры распределения электропитания в серверной стойке отвечают следующие объекты: 

* Потребители питания. К ним относятся блоки питания серверного оборудования. 
* Поставщики питания. К ним относятся лучи питания и PDU находящиеся вне юнитов стойки, а также PDU размещенные в юнитах стойки.

Для настройки сбора данных потребления по протоколу SNMP требуется: 

1. Открыть раздел "Настройки мониторинга" и выбрать "Шаблоны мониторинга оборудования".
2. Выбрать требуемый шаблон мониторинга и перейти на вкладку "Системные метрики".
3. Выбрать системную метрику "Текущее энергопотребление" и выбрать протокол SNMP.
4. Далее выбрать способ создания из Mib файла, Zabbix конфигурации или создать метрику вручную. 
5. Сохранить настройки параметров сбора данных питания.

> ***Система автоматически создает потребителей питания оборудования, при наличии подключения по протоколу Redfish или настроенным параметрам сбора данных по протоколу SNMP***

Для создания поставщиков питания: 

1. Выберите область размещения поставщика в юните или за его пределами. 
2. Нажмите на иконку создания поставщика. Цвет и наименование поставщика будут заданы автоматически. 
3. Для редактирования поставщика, выберите его из списка и нажмите на кнопку "Редактировать".
4. Для удаления поставщика, выберите его из списка и нажмите на кнопку "Удалить" 

Система позволяет создавать связи между потребителями и поставщиками питания. 

> **ВАЖНО!** ***В зависимости от выбранного протокола сбор данных по потребителям питания может занимать разное время***
>
> ***Следует учитывать, что при указании максимальной мощности поставщика питания, количество подключаемых потребителей будет ограничено их суммарным значением мощности***

1. Для создания связи выберите потребителя питания и перетаскиванием от потребителя питания к поставщику создайте связь. Цвет связи будет назначен автоматически в соответствии с выбранным поставщиком. 
2. Для удаления данной связи, нажмите на нее ПКМ и выберите "Удалить"

### 5.5 Настройка параметров и каналов отправки уведомлений

Настройка и управление пользовательских уведомлений осуществляется в разделе "Настройка уведомлений".   

#### 5.5.1 Настройка Telegram-bot

Выполните следующие шаги для настройки: 

1. `https://t.me/BotFather` - открыть пользователя;  
2. `/newbot` - отправить данную команду; 
3. `ems-bot-${MY_NAME}` - отправить имя бота;  
4. `/setuserpic`, `ems-bot-${MY_NAME}` - установить аватар бота (при необходимости); 
5. В ответ будет отправлен токен доступа бота. Необходимо его скопировать, открыть ВМ - `master-node`, открыть файл `~/installer/app.env`. В значение переменной `TELEGRAM_KEY` ввести токен доступа бота, далее запустить скрипт `~/installer/install_master-node.sh`;
6. Для активации бота необходимо открыть в системе EMS карточку пользователя (пользователя SuperAdmin редактировать нельзя, необходимо завести свой аккаунт) и в поле `Логин в telegram` ввести логин в Telegram в формате `my_login`, без символа `@` в начале;
7. Открыть в Telegram бота `ems-bot-${MY_NAME}` и отправить сообщение `/start` (**выполняется пользователем**);  
8. В ответ бот пришлет `Аккаунт добавлен в систему EMS.`.  

Как только аккаунт пользователя будет добавлен, он сможет получать уведомления в Telegram.  

#### 5.5.2 Настройка SMTP сервера

Для настройки отправки уведомлений на электронную почту перейдите в раздел "Настройка системы" >> "Настройка SMTP", нажмите "Редактировать".   

Настройте параметры подключения:  
* Адрес;  
* Порт; 
* SSL.  

Настройте параметры авторизации:  
* Логин;  
* Пароль. 

Настройте параметры отправителя:  
* Имя отправителя;  
* Адрес отправителя.  

Введите авторизационные данные администратора. Укажите имя и адрес отправителя. Сохраните внесенные настройки.  

> ***Для удаления настроек SMTP сервера необходимо нажать "Редактировать", очистить все поля (вручную) и сохранить изменения***

#### 5.5.3 Настройка подключения и отправки данных в SIEM

Система предоставляет возможность подключения к SIEM и настройки параметров передачи данных аудита. 

Для настройки подключения перейдите в раздел "Настройка системы" >> "Настройка SIEM", нажмите "Редактировать".   

Отправка событий настраивается отдельным параметром: 
* Отправка событий в SIEM. 

Настройте параметры подключения к SIEM:  
* Использовать TLS;
* Протокол подключения;
* Формат сообщения;
* Сертификат клиента;
* Пароль сертификата клиента;
* Порт;
* Адрес сервера;
* Категория события.

Настройте формат отправляемого сообщения:
* json;
* plaintext;
* cef.

#### 5.5.4 Настройка SMS сервера

Система предоставляет возможность использовать способ отправки уведомлений по SMS через SMPP-шлюз. Для настройки SMS-сервера обратитесь к администратору EMS. 

> ***Отправка SMS сообщений возможна только на учетные записи с указанным номером телефона*** 
> 
> ***Выбор используемого SMPP-шлюза остается за администратором системы*** 
>
> ***Описание интеграции с SMPP описано в руководстве администратора***

#### 5.5.5 Профили уведомлений

В подразделе "Профили уведомлений" расположен перечень предварительно настроенных профилей уведомлений о событиях в системе, которые может получить пользователь.  
Возможны следующие способы оповещения пользователей:  

* оповещение на сайте (уведомления в пользовательском интерфейсе);  
* оповещение по E-mail (предварительно настройте SMTP);  
* оповещение в Telegram (предварительно настройте Telegram бота); 
* SMS оповещение (предварительно настройте SMPP-шлюз). 

Для настройки профиля перейдите в него, кликнув по полю профиля ЛКМ. 

#### 5.5.6 Настройка уведомлений для роли

Настройка уведомлений для ролей предназначена для оповещения группы пользователей, объединенных ролью/должностью/подразделением.  
1. В профиле уведомления на вкладке "Настройка ролей" нажмите кнопку "Добавить". 
2. В окне создания получателя выберите:  

   * Роль получателя;  
   * Подразделение получателя; 
   * Способы оповещения. 

3. Поставьте метку "Активно" для активации настройки и нажмите "Создать".  

#### 5.5.7 Настройка уведомлений для пользователя

Данная настройка предназначается для индивидуального оповещения пользователя. 
1. В профиле уведомления на вкладке "Настройки пользователей" нажмите кнопку "Добавить". 
2. В окне создания получателя выберите:  

   * Пользователя; 
   * Способ оповещения.  

3. Поставьте метку "Активно" для активации настройки и нажмите "Создать".  

#### 5.5.8 Настройка уведомлений Webhook

Для настройки отправки уведомлений во внешние системы перейдите на вкладку "Webhook настройки". 
1. Нажмите кнопку "Добавить".  
2. В окне создания получателя заполните: 

   * Имя внешней системы;  
   * Комментарий;  
   * URL внешней системы;  
   * Выберите тип файла (JSON/TXT).  

3. Поставьте метку "Активно" для активации настройки и нажмите "Применить".  

#### 5.5.9 Режим обслуживания 

Данный режим предназначен для ограничения отправки оповещений пользователям, о событиях на устройствах в течении выбранного периода, без удаления настроек мониторинга или удаления самого устройства из системы, для проведения ремонтных или профилактических работ над ОМиУ, заведенным в систему, а также индикации, о том, что устройство находится на обслуживание. 

Режим обслуживания может быть установлен из карточки выбранного устройства.
Для этого:
1. Перейдите в карточку целевого устройства;
2. Выберите "Поставить оборудование на обслуживание";
3. Укажите период обслуживания оборудования и нажмите "Сохранить".  

![Режим обслуживания. Карточка устройства](./media/EMS_user_guide_files/EMS_service_mode_device_card.png "Режим обслуживания. Карточка устройства")

Для постановки группы оборудования на обслуживание: 
1. Перейдите в целевую директорию логического проводника выбранного кластера;
2. Нажмите кнопку "Настройка плана обслуживания" для вызова интерфейса настроек периода обслуживания;
3. Укажите период обслуживания оборудования и нажмите "Сохранить";
4. Выберите устройства к которым будет применены настройки режима обслуживания и нажмите кнопку "Поставить на обслуживание".  

![Режим обслуживания. Логический проводник](./media/EMS_user_guide_files/EMS_service_mode_device_explorer "Режим обслуживания. Логический проводник")

Для просмотра всех устройств с установленным или запланированным режимом обслуживания, а также редактирования перейдите во вкладку "Настройка мониторинга" и перейдите в раздел "План обслуживания". 
Для вывода устройств из обслуживания или редактирования его периода, а также комментариев, выберите устройства и нажмите изменить. В всплывающем окне укажите новые данные и нажмите кнопку "Сохранить". 

> ***Для обозначения режима обслуживания на устройства используется следующая индикация:*** 
> ***Режим обслуживания установлен - желтый индикатор;***
> ***Режим обслуживания запланирован - синий индикатор.***

![План обслуживания](./media/EMS_user_guide_files/EMS_service_plan "План обслуживания")

### 5.6 Заведение объектов мониторинга в систему

#### 5.6.1 Обнаружение и добавление ОМиУ в систему 

##### Серверное оборудование и виртуальные машины 

Обнаружение оборудования осуществляется в разделе "Проводник" в целевой директории выбранного кластера.
Нажмите кнопку "Добавить" и выберите пункт "Добавить оборудование".
В открывшемся интерфейсе заполните параметры обнаружения оборудования. 
Обнаружение оборудования в сети кластера возможно по следующим параметрам:

* Маска подсети;
* Диапазон IP адресов;
* Одиночный IP адрес;
* Доменное имя.

> ***Обнаружение может быть выполнено по нескольким параметрам одновременно***

![Интерфейс обнаружения](./media/EMS_user_guide_files/EMS_visard_discovery.png "Интерфейс обнаружения")

Для обнаружения устройств введите параметры обнаружения и нажмите "Запустить проверку".

> ***В системе реализован функционал проверки корректности заполнения адресов обнаружения***

После выполнения операции, оборудованию, обнаруженному по указанным адресам, будет присвоено соответствующее состояние.  

![Обнаружение. Результаты обнаружения](./media/EMS_user_guide_files/EMS_visard_oborudovanie.png "Обнаружение. Результаты обнаружения")

Для заведения обнаруженных устройств в систему нажмите на кнопку "Перейти в лист обнаружения". 

> ***В случае наличия предварительно настроенного шаблона мониторинга оборудования с данными подключения по протоколам, система автоматически начнет опрашивать обнаруженные устройства***

Обязательным условием для заведения оборудования в систему является наличие заполненных полей: 

* Модель оборудования; 
* Серийный номер. 

В случае отсутствия заполнения обязательных полей обнаруженного оборудования, карточки устройств будут выделены и система укажет какое поле не было заполнено. 

Для быстрого решения конфликтов заведения оборудования при работе с большим списком устройств, нажмите на кнопку "Требуют вмешательства". Отобразиться список устройств с обозначенными полями, где требуется решить конфликт. 

> ***В случае обнаружения нескольких вариантов значений у поля устройства по которому есть конфликт, необходимо выбрать одно из предложенных***
>
> ***В системе представлен функционал по массовому заполнению полей "Стойка" и "Модель" у обнаруженных устройств***

В случае отсутствия предварительно настроенного шаблона мониторинга, можно указать данные подключения у каждого устройства отдельно или указать общие данные на перечень выбранных устройств из списка обнаружения. 

Для этого отметьте устройства или нажмите кнопку "Выбрать все". Далее нажмите кнопку "Общие настройки подключения", выберите протокол и заполните данные подключения.

![Обнаружение. Настройка подключения](./media/EMS_user_guide_files/EMS_visard_dannie_podluchenia.png "Данные подключения")

Нажмите кнопку запуска для подключения по выбранному протоколу.

Для просмотра результатов опроса оборудования по введенным протоколам, в системе реализован функционал "Журнал проверок". Вызов журнала осуществляется из интерфейса общих настроек подключения.  

![Обнаружение. Журнал проверок](./media/EMS_user_guide_files/EMS_visard_journal.png "Журнал проверок подключения")

Для завершения процедуры заведения оборудования в систему, выберите устройства и нажмите кнопку "Завести".
После завершения процесса добавления обнаруженных устройств в систему, перейдите в директорию куда осуществлялось заведение. Там будут отображены справочные данные и состояние заведенных устройств.

> ***В случае, если обнаружение и заведение устройства было выполнено по доменному имени и устройство находится в другой подсети от кластера, в рамках которого производилось обнаружение, то mac-адрес не будет совмещен с доменным именем устройства в его карточке (вкладка "Сети"), а будет добавлен отдельно***

##### Гипервизоры

В системе присутствует два способа заведения гипервизоров в систему: 

**Обнаружение через сетевой интерфейс и последующее заведение (доступно только для гипервизоров ESXI)**

Обнаружение осуществляется аналогично как и для оборудования с учетом того, что в настройках подключения необходимо указать данные подключения к гипервизору ESXI и указать обязательные поля в соответствии с добавляемым гипервизором. Далее нажмите кнопку "Закончить".
После завершения процесса добавления обнаруженного устройства в систему, перейдите в директорию данного устройства, где будут отображены справочные данные и его состояние.

**Заведение через карточку хостового устройства** 

Для добавления гипервизора откройте в "Карточке устройства" > вкладку "Гипервизор" и нажмите "Добавить гипервизор". 

![Карточка устройства. Гипервизоры](./media/EMS_user_guide_files/EMS_device_hypervisor.png "Карточка устройства.Гипервизоры")

Заполните название гипервизорва. 
Выберите тип гипервизора.  

> **Реализованна поддержка следующих типов гипервизоров:**   
> * **VmWare ESXI - версий 6, 7, 8;**   
> * **QEMU-base - от 4 версии и выше.**

Выберите сетевой интерфейс.
Введите авторизационные данные логина и пароля.

> **URL гипервизора заполняется автоматически и соответствует IP гипервизора**.
>
> **В случае, если поля логин/пароль не заполнены автоматически, необходимо ввести логин/пароль сетевого подключения IPMI либо Redfish. Эти данные можно найти в карточке устройства во вкладке "Сети".** 

Нажмите кнопку "Проверить" для определения гипервизора. При положительном результате отобразится зеленая галка, кнопка "Проверить" сменится на кнопку "Добавить".

Нажмите "Добавить". 
На вкладке "Гипервизоры" отображается информация о статусе доступности гипервизора, справочной информации, данных подключения, виртуальных машин добавленного гипервизора и данные по использованию ресурсов.

> **Важно!**  ***Отображение списка виртуальных машин и утилизации их ресурсов доступно только для гипервизоров VmWare ESXI***

##### Сервисы и системы

**Системы**

Система представляет собой группировку сервисов, наличие которой является обязательным предварительным условием при заведении сервисов. 

Для создания системы откройте проводник и перейдите в целевую директорию кластера. 
1. Нажмите кнопку "Добавить" и выберите пункт "Создать систему".   
2. Укажите название системы, установите целевой показатель SLO и нажмите "Применить".   
Созданная система отобразится в директории.  

**Сервисы**

Для заведения в систему и постановки на мониторинг сервисов, развернутых на оборудовании, необходимо выполнить следующие действия:

**1. Добавление типа сервиса**   

Откройте раздел "Справочный каталог" и перейдите в "Типы сервисов". 
1. Нажмите кнопку "Добавить". 
2. В окне создания заполните название типа сервиса. При необходимости заполните поле "Описание".   
3. Нажмите кнопку "Создать". Новый элемент типа сервиса сохранится в каталоге.   

**2. Добавление тега**  

Откройте раздел "Справочный каталог" и перейдите в "Теги". 
1. Нажмите кнопку "Добавить". 
2. В окне создания заполните название тега. При необходимости заполните поле "Описание" и выберите цвет тега.  
3. Нажмите кнопку "Создать". Новый элемент тега сохранится в каталоге. 

**3. Добавление тега к оборудованию**  

1. Откройте созданный тег, кликнув его ЛКМ.  
2. В нижней части экрана нажмите кнопку "Добавить".   
3. Выберите в проводнике необходимое устройство и нажмите "Продолжить". 
   В карточке тега появилась запись о привязке тега к выбранному устройству.  
 
**4. Добавление инстанса сервиса**  

Откройте проводник, перейдите в директорию и выберите устройство для добавления инстанса сервиса.  
1. Откройте карточку устройства и перейдите на вкладку "Сети". 
2. В поле "Сервисы" нажмите "Добавить инстанс". 
3. Укажите порт или URL и выберите протокол для проверки сервиса. 
4. Нажмите "Проверить". 
5. При успешной проверке откроется форма создания нового инстанса сервиса. 
6. Заполните название нового инстанса.    
7. При желании укажите хостнейм (по умолчанию используется IP-адрес).   
8. Выберите тип сервиса и систему.  
9. Нажмите "Создать".   
Инстанс сервиса будет отображаться в карточке устройства на вкладке "Сети".   

### 5.7 Настройка и мониторинг объектов инфраструктуры

#### 5.7.1 Настройка шаблона мониторинга оборудования 

Шаблоны мониторинга оборудования предназначены для повышения качества обнаружения оборудования, сбора инвентарной информации и отслеживания показателей сенсоров по заданным метрикам. Система предоставляет возможность пользователю самостоятельно настроить правила мониторинга как для отдельного объекта, так и создать шаблон, который можно применять к другим объектам мониторинга.

Для создания шаблона мониторинга оборудования перейдите в раздел "Настройка мониторинга" и выберите подраздел "Шаблоны мониторинга оборудования".

Конфигурирование шаблона происходит с помощью визарда. Визард представляет из себя пошаговый набор действий по созданию шаблона мониторинга, позволяющий учесть все особенности инфраструктуры, устройства которой будут поставлены на мониторинг.
Для создания нового шаблона мониторинга нажмите "Добавить" в окне «Шаблоны мониторинга». В открывшемся визарде необходимо настроить конфигурации шаблона мониторинга:

![Визард шаблона мониторинга](./media/EMS_user_guide_files/EMS_visard_monitoring.png "Визард шаблона мониторинга")

1. Общая информация шаблона.
   На первом шаге нужно заполнить название шаблона и его описание.
2. Объекты мониторинга.
   На втором шаге выбрать объекты, к которым будет применен данный шаблон мониторинга.
3. Инвентарная информация.
   На этом шаге нужно сформировать перечень инвентарной информации и протоколов, по которым будет собираться информация. Атрибут можно создать вручную, либо воспользоваться браузером:
   * Вручную - выберите протокол сбора информации и нажмите кнопку "Добавить". Заполните название атрибута, маршрут и нажмите кнопку "Создать". 
   * Для автоматического заполнения конфигураций сбора инвентарной информации можно воспользоваться браузером выбранного протокола (IPMI, Redfish, SMART). Для протокола SNMP используются MIB или Zabbix браузеры. Нажмите на кнопку браузера и во всплывающем окне отметьте "Выбор заведенного устройства".
   * Нажмите кнопку "Выберите устройство" для перехода в проводник к спискам заведенных устройств. Отметьте нужное устройство и нажмите кнопку "Продолжить".
   * Выберите необходимые атрибуты и нажмите кнопку "Добавить".

> **Важно!**  ***Если устройство ранее не было добавлено, то возможно прозвонить его прямо из окна создания шаблона и выбрать необходимые атрибуты.***
> 
> ***Отметьте "Заполнение вручную" и укажите поля параметров обнаружения.***

4. Сенсоры.
   На этом шаге необходимо сформировать перечень сенсоров и протоколов, по которым будет собираться информация.
   Заполните информацию о сенсорах аналогично шагу 3 "Инвентарная информация".
5. Системные метрики.
   На этом шаге необходимо сформировать перечень собираемой справочной информации (системные метрики) и протоколов, по которым она будет собираться.
  
6. Данные подключения.
   Завершающий шаг создания шаблона мониторинга, на котором необходимо указать данные подключения к оборудованию и поставьте отметку в "Использовать при обнаружении" для автоматического применения при обнаружении устройства.
7. Подтвердите создание шаблона нажав на кнопку "Закончить".
8. Настройка шаблона событий.
   Настройка шаблона событий позволяет задать критерии событий, которые будут фиксироваться в "Журнале событий" в карточке устройства (вкладка "События").
   Для настройки шаблона события перейдите в созданный шаблон мониторинга оборудования и откройте вкладку "Шаблоны событий".
   Нажмите кнопку "Добавить".    
   В открывшемся окне "Создание шаблона события" заполните: 
   * Название - название шаблона;
   * Шаблон события - условие выборки событий из общего массива (***Примечание - Будут обработаны и сохранены лишь события, подходящие под данное условие***); 
   * Тип шаблона - условие выборки событий из общего массива:  
     * Contains - содержит;   
     * EndWith - заканчивается на;  
     * NotContains - не содержит;   
     * Regex - регулярное выражение;   
     * StartWith - начинается с. 
   * Протокол - протокол сбора события (Syslog, IPMI, Redfish);
   * Чувствительность к регистру - проверка на соответствие верхнего/нижнего регистра в событии.

**Импорт и экспорт шаблонов мониторинга оборудования**

В EMS доступны возможности загрузки и выгрузки файлов шаблонов мониторинга оборудования в формате JSON.

**Импорт шаблона**

Для загрузки шаблона в подразделе "Шаблоны мониторинга оборудования" нажмите кнопку "Импорт шаблона". 
1. В открывшемся окне проводника укажите путь к файлу шаблона и нажмите "Открыть".
2. Подождите загрузку файла. После успешной загрузки шаблона в верхней части экрана вы увидите уведомление "Импорт успешно завершен".
3. Шаблон отображается в общем списке шаблонов и готов к применению.

> ***Импорт шаблонов мониторинга доступен только между системами одной версии***

**Экспорт шаблона**

Для выгрузки шаблона в подразделе "Шаблоны мониторинга оборудования" откройте необходимый шаблон.
1. Рядом с наименованием шаблона кнопка "Экспорт шаблона". Нажмите на нее для начала скачивания файла в формате JSON.
2. Экспортированный файл сохранится на вашем устройстве (место для скачивания файла указывается в настройках используемого браузера).

#### 5.7.2 Настройка шаблона мониторинга систем

Шаблоны мониторинга систем предназначены для предварительной настройки параметров мониторинга веб-серверов (сервисов) и групп веб-серверов (систем), которые развернуты на ОМиУ заведенных в EMS. 
Для создания шаблона мониторинга систем перейдите в раздел "Настройка мониторинга" и выберите подраздел "Шаблоны мониторинга систем".

Конфигурирование шаблона происходит с помощью визарда. Визард представляет из себя пошаговый набор действий по созданию шаблона мониторинга, позволяющий гибко учесть ОМиУ, на которых размещены сервисы, системы и правила их мониторинга.
Для создания нового шаблона мониторинга нажмите "Добавить" в окне «Шаблоны мониторинга систем». В открывшемся визарде необходимо настроить конфигурации шаблона мониторинга систем:

1. Общая информация шаблона.
   На первом шаге нужно заполнить название шаблона, его описание и нажать "Далее".
2. Настройка шаблона мониторинга.
   На втором шаге нужно выбрать типы сервисов, которые будут определять инстансы сервисов, относящихся к данному типу, и теги устройств, которые будут определять ОМиУ, на которых требуется мониторить сервисы и нажать "Далее". 

3. Настройка правил мониторинга.
   На этом шаге нужно сформировать одно или несколько правил мониторинга сервиса, по которым будет осуществляться сбор информации. 

##### Формирование правила мониторинга сервисов 

Правило мониторинга может быть создано в существующем шаблоне мониторинга или в новом, но стоит учитывать, что тип сервиса и тег устройства определяется на уровне шаблона мониторинга и создаваемое правило может не отработать, так как не будет определен сам сервис.
Правило мониторинга может быть создано для мониторинга сервиса только по одному из следующих протоколов: 
   * HTTP;
   * TCP;
   * GRPC;
   * UDP;
   * WS.

![Настройка правил. Выбор протокола](./media/EMS_user_guide_files/EMS_system_monitoring.png "Настройка правил. Выбор протокола")

В свою очередь, шаблон мониторинга может включать в себя правила сформированные для мониторинга сервисов по разным протоколам. 
Для создаваемого правила мониторинга также можно определить значение SLO, которое будет применено к графикам сервисов, которые будут мониторится по данному правилу. Значение SLO по умолчанию 95%. 

Для создания правила, выберите протокол и нажмите кнопку "Добавить". 
1. Укажите название создаваемого правила. 
2. Укажите описание создаваемого правила.
3. Укажите параметры настройки доступа к сервису по правилу мониторинга, которые представлены в виде следующих разделов и полей:
   * Игнорировать проверку TLS/SSL - при выборе данного параметра проверка подлинности игнорируется;
   * Использовать mTLS - при выборе данного параметра осуществляется проверка подлинности сервера и клиента отправляющего запрос. В данном случает требуется добавить сертификат CA и Сертификат клиента;
   * Использовать TLS - при выборе данного параметра осуществляется проверка подлинности только сервера. В данном случает требуется добавить сертификат CA;
   * Сертификат CA - выбор соответствующего сертификата;
   * Сертификат клиента - выбор соответствующего сертификата;
   * Порт - заполняется автоматически значением которое было указано при проверки доступности и заведении инстанса сервиса на устройстве;
   * Время ожидания запроса - время, по которому правило мониторинга будет пытаться получить ответ от сервиса. По умолчанию установлено значение в 5000 мс.

![Параметры доступа к сервису](./media/EMS_user_guide_files/EMS_system_monitoring_parametry.png "Параметры доступа к сервису") 

1. Сформируйте конфигурацию запроса правила мониторинга к сервису: 
   * Путь запроса - URI (Uniform Resource Identifier, унифицированный идентификатор ресурса) — путь до конкретного ресурса, над которым необходимо осуществить операцию (например, в случае использования метода GET подразумевается получение ресурса);
   * Заголовок запроса - содержит дополнительную информацию о ресурсе, который нужно получить;
   * Параметры запроса - дополнительные атрибуты запроса выбранного ресурса;
   * Схема запроса - определяет операцию, которую нужно осуществить с указанным ресурсом. Например: GET, PUT, POST, DELETE, HEAD, OPTIONS, TRACE, CONNECT, PATCH;
   * Версия протокола - определяет, в соответствии с какой версией стандарта HTTP составлен запрос;
   * Тело запроса - сформированное тело запроса из настроенных выше параметров.
 
> ***Поле Заголовки и Параметры запроса являются необязательными. Если значения заголовков и параметров не нужны нажмите кнопку "-".***

![Конфигурации запроса](./media/EMS_user_guide_files/EMS_system_monitoring_zapros.png "Конфигурации запроса") 

1. Сформируйте конфигурацию ожидаемого ответа по правилу мониторинга от опрашиваемого сервиса:
   * Шаблон заголовков ответа - содержит дополнительную информацию в ответе от ресурса, к которому был сформирован запрос;
   * Чувствительность к регистру заголовка ответа - включает проверку регистра заголовков;
   * Тип проверки заголовка ответа - определяет проверку заголовка ответа по заданному условию;
   * Чувствительность к регистру тела ответа - включает проверку регистра тела ответа
   * Тип проверки тела ответа - определяет проверку тела ответа по заданному условию;
   * Шаблон тела ответа - сформированное тело ответа из настроенных выше параметров. 

> ***Поля Шаблон заголовков ответа является необязательным. Если значения заголовков ответа не нужны нажмите кнопку "-".***

![Конфигурации ответа](./media/EMS_user_guide_files/EMS_system_monitoring_otvet.png "Конфигурации ответа")

1. Выполните сохранение сформированного правила, нажав на кнопку "Сохранить правило". 

> ***Данные конфигурации доступны по протоколам GRPC, HTTP, WebSocket.***
> 
> ***Для протоколов TCP, UDP конфигурации запроса и ответа ограничены телом запроса и телом ответа.*** 

##### Проверка правила мониторинга

После формирования основной структуры правила мониторинга, можно выполнить его проверку. Для проведения проверки создаваемого правила мониторинга сервисов будут применены следующие условия: 
* Фильтр выбора оборудования, на котором находятся сервисы, обнаружит только те устройства, которым назначен тег выбранный при формировании шаблона мониторинга;  
* Фильтр выбора сервиса обнаружит только те сервисы, которые относятся к типу, который был выбран при формировании шаблона мониторинга. 

Для вызова окна выбора сервиса, на котором будет выполнена проверка правила, требуется нажать на кнопку "Проверить правило". 

![Проверка правила](./media/EMS_user_guide_files/EMS_system_monitoring_proverka.png "Проверка правила. Выбор оборудования")

1. В открывшемся окне выберите оборудование, на котором размещен сервис, по которому будет выполнена проверка. 
2. Выберите сетевой интерфейс устройства, на котором находится сервис; 
3. Выберите сервис для проверки правила и нажмите кнопку "Проверить". 

> ***Устройство не будет отображено в перечне доступных для выбора, если на него не назначен тег, который был указан в шаблоне мониторинга***
> 
> ***В случае корректного формирования правила мониторинга система предоставит ответ по состоянию выбранного сервиса. Если ответ будет некорректный или не будет получен, правило может быть скорректировано и перепроверено с учетом уже выбранного сервиса. В случае необходимости сервис для проведения проверки может быть изменен при нажатии на кнопку "Перевыбрать"*** 

### 5.8 Визуализация данных мониторинга

#### 5.8.1 Карточка устройства

Для просмотра справочной и инвентарной информации, состояния сетей, сенсоров, электропитания и событий устройства перейдите в раздел "Проводник", выберите директорию и устройство.
Перейти к подробной информации устройства можно при помощи двойного клика ЛКМ.

Информационные разделы карточки устройства:

1. **Общая информация**  - раздел состоит из подразделов:   

   1.1 ***Основная информация*** 

![Карточка устройства. Основная информация](./media/EMS_user_guide_files/EMS_card_basic_information.png "Основная информация")

   В основную информацию карточки устройства входит:

   * Справочная информация - содержит базовую информация об устройстве (серийный номер, тип, модель и производитель устройства, физическое расположение, версии BMC/BIOS).  

   >  ***Атрибуты **"Здание"**, **"Помещение"** и **"Стойка"** являются связанными между собой в рамках выбранного устройства*** 
   
   * Текущее состояние - информация о текущих показателях доступности сетевых интерфейсов, BMC, сенсоров и электропитания.
   * Энергопотребление - показатели энергопотребления устройства: текущее значение, среднее и пиковое за выбранный период. Информация представлена в виде целых чисел, а также в графическом представлении изменения на временной шкале.
   * Температура - системная метрика отображающая значение температуры устройства. Настройка метрики осуществляется в шаблонах мониторинга оборудования.

   1.2 ***Дополнительная информация об устройстве*** - содержит список кастомных полей, созданных и добавленных пользователем. 

   Для редактирования списка кастомных полей и заполнения их значений нажмите "Редактировать".
   Выберите из списка дополнительных полей нужное, поставив отметку в чекбоксе, и нажмите "Добавить в оборудование".
   Или создайте новое поле, для этого нажмите "Создать поле" и укажите техническое и системное названия для него.
   Заполните дополнительное поле необходимым текстовым значением и завершите редактирование. 

   > ***Дополнительные поля могут быть добавленны для отображения в проводнике. Для этого перейдите к списку устройств директории, нажмите конпку "Настройка таблицы" и выберите поля для отображения***
   >
   > ***Общее управление дополнительными полями доступно в разделе "Настройки системы" >> "Дополнительные поля оборудования"***

   1.3 ***Инвентарная информация*** - содержит полный перечень инвентарной информации собранной с устройства   
   1.4 ***Агенты мониторинга*** - содержит информацию о статусе агента мониторинга, установленного на устройстве  
   1.5 ***Карта связей устройства*** - локальная карта связей устройства, визуальное представление устройства и его связей с другими устройствами. Работа с [Картой](###Карта-визуализации-ОМиУ-и-связей) была описана выше.  
   1.6 ***Блейд-серверы*** - содержит список блейд-серверов, подключенных к блейд-корзине, и возможность быстрого перехода к ним (*раздел доступен только в случае, если выбранное устройство является блейд-корзиной*) 
 
2. **Операционные системы** - содержит информацию об установленной операционной системе на оборудовании, ее хостнейм, архитектуру и версию;
   
3. **Оперативная память**  - содержит информацию об оперативной памяти устройства, а также возможность просмотра графиков ее изменения;
   
4. **Процессоры** - содержит информацию о процессорах и статистических данных их производительности, а также возможностью просмотра графиков их изменения;

 > ***Следует учитывать, что устройства с операционной системой CentOS 7.9 не предоставляют данные по загрузке ядер в связи с ограничениями самой ОС***
 
5. **Диски** - содержит информацию о дисковом пространстве устройства, включая статус состояния диска;

 > ***Следует учитывать, что для получение SMART данных с дисков оборудования требуется наличие поддержки данной технологии и `smartctl` демона на целевом устройстве***
   
6. **Сети** - содержит информацию о сетевых интерфейсах и графики доступности данного оборудования по протоколам, где было настроено подключение.

В разделе "Сети" доступны следующие инструменты:
   * **Файловый менеджер (SFTP)**  - интерфейс управления файлами ОС хоста;
   * **SSH терминал** - интерфейс консоли терминала SSH;
   * **График доступности** - просмотр доступности сетевых интерфейсов по выбранным протоколам;
   * **BMC консоль** - переход к управлению BMC консолью выбранного устройства;
   * **Быстрый доступ к BMC консоли** - доступ к управлению BMC консоли посредством SSO;
   * **Сервисы** - создания инстанса сервиса.

> ***Файловый менеджер и SSH Терминал доступны только при наличие подключения по протоколу SSH***

7. **Гипервизор** - содержит информацию о гипервизоре и виртуальных машинах. 
  
8. **События** - содержит перечень событий устройства с возможностью настройки временного периода и фильтрации по уровню критичности для формирования отчета.
   
9.  **Операции** - содержит информацию об операциях системы в рамках выбранного оборудования с возможностью настройки временного периода для формирования отчета.  Описание настройки и запуска операций управления оборудованием отображено в разделе "Управление".
   
10. **Мониторинг** - содержит информацию об используемых шаблонах мониторинга, применяемых к выбранному оборудованию. Описание создания и настройки шаблонов мониторинга оборудования отображено в разделе "Настройка шаблона мониторинга оборудования".

#### 5.8.2 Дашборды системы

Дашборды доступности устройств и использования ресурсов находится на главном экране системы, но дополнительно можно сформировать дашборд по следующим группам оборудования: 

* Помещение; 
* Стойка.

> ***Для отображения дашбора по группе оборудования (стойка или помещение), перейдите к данному объекту и нажмите ЛКМ на кнопке "Сформировать дашборд" и выберите "Открыть ссылку в соседнем окне". Дашборд будет открыт в соседней вкладке*** 

![Дашборд](./media/EMS_user_guide_files/EMS_dashboard.png "Дашборд") 

По умолчанию на главной странице отображается глобальный дашборд, включающий в себя информацию по всем добавленным в систему устройствам. 
Для создания пользовательского дашборда нажмите "Выбрать другой дашборд" >> "Создать новый из проводника".
1. Будет выполнен переход в проводник системы для выбора устройств. 
2. Перейдите в кластер и отметьте директории, по устройствам которых необходимо отображать информацию на дашборде и нажмите "Продолжить".
3. Созданный дашборд отображает совокупную информацию выбранных устройств.

Доступность устройств обозначена статусами:
* **Доступные**
* **Предупреждения**
* **Ошибки**
* **Недоступные**

По каждому статусу указано количество устройств в реальном времени и процент от общего количества выбранных.

Информация по потреблению ресурсов по следующим атрибутам:
* **Оперативная память** - количество и процент от использования объема оперативной памяти;
* **Диски** - количество и процент использования дискового пространства;
* **Энергопотребление** - количество электропотребления;
* **CPU** - процент от потребляемой мощности.

Для просмотра графика изменений показателей доступности и потребления ресурсов устройств нажмите "Показать график". 
При необходимости выберите период, за который вы хотите получить информацию изменений:
* **Д** - день;
* **Н** - неделя;
* **М** - месяц;
* **3М** - три месяца;
* **6М** - шесть месяцев.

Информация отображаемая на дашборде обновляется каждые 15 минут.

На дашборде доступности представлена возможность просмотра списка событий добавленных устройств, и списка IP адресов добавленных устройств. Для просмотра списков событий или устройств разверните соответствующую вкладку в правом верхнем углу экрана. 

> ***При наличии более одного созданного дашборда выберите какой из дашбордов будет отображаться по умолчанию при переходе на главную страницу. Для этого нажмите "Выбрать другой дашборд", выберите необходимый и нажмите "По умолчанию"*** 

#### 5.8.3 Карта визуализации ОМиУ и связей

Карта связей необходима для визуализации объектов системы, их вложенности, состояния и связей.
По умолчанию карта связей формируется автоматически по всем устройствам добавленным в EMS. 
Для просмотра стандартной карты, создания и редактирования дополнительных карт перейдите в раздел "Настройка мониторинга" >> "Карты связей устройств".
Для просмотра стандартной карты связей кликните по названию "Стандартная карта" ЛКМ.
Для создания дополнительной пользовательской карты выполните следующие действия: 
   1. В разделе "карты связей устройств" нажмите кнопку "Добавить";  
   2. Укажите название карты, описание и нажмите "Создать";
   3. Откройте созданную карту в режиме редактирования нажатием ЛКМ;
   4. Для добавления объектов на карту нажмите на кнопку "Добавить объекты" и в открывшемся окне проводника выберите нужные объекты. 

![Настройка карты визуализации](./media/EMS_user_guide_files/EMS_map_setting.png "Настройка карты визуализации")

> ***ВАЖНО! Стоит учитывать, что на карту можно добавить только те объекты, к которым предоставлен доступ***   
 
1. Для добавления связей между объектами выберите объект на карте, от которого нужно построить связь. Далее выберите объект, к которому нужно построить связь и нажмите на кнопку "Связать объекты". 

> ***ВАЖНО! Стоит учитывать, что созданная связь сохранится за выбранными устройствами и будет отображена на всех существующих картах.***

2. Для удаления связей и объектов с карты выберите необходимый элемент и нажмите кнопку "Удалить объекты".   

#### Взаимодействие с картой связей

Карта визуализации позволяет взаимодействовать с объектами, которые были добавлены. К взаимодействую относятся следующие действия: 

   1. Вращение камеры вокруг объектов;
   2. Масштабирование объектов;
   3. Получение справочной информации и данных по мониторингу выбранного объекта. Для вызова окна с информацией необходимо нажать ПКМ по объекту карты; 
   4. Отображение вложенности выбранного устройства. Для отображения вложенных устройств необходимо нажать Ctrl + ПКМ по объекту карты;
   5. Информация об устройстве. Для вывода справочной информации об устройстве на карте визуализации нажмите Shift + ПКМ по объекту карты. 

![Карта визуализации. Отображение вложенности](./media/EMS_user_guide_files/EMS_map_vlozenie.png "Карта визуализации. Отображение вложенности")

#### 5.8.4 Отчеты

В системе представлена возможность формирования и выгрузки отчетов о конфигурациях, инвентарной информации и событиях ОМиУ.

##### Отчеты по оборудованию добавленному на дашборд 

Для экспорта отчетов мониторинга по **Доступности**, **Ресурсам** и **Событиям** откройте дашборд системы. 
1. Нажмите кнопку "Выгрузить" на отображаемом дашборде;
2. Выберите соответствующий отчет;
3. Выберите период формирования отчета и нажмите "Экспортировать".

Сформированный отчет в файле формата *.xlsx* будет скачан на ваше устройство в папку по умолчанию указанную в настройках браузера.

##### Отчет о событиях оборудования

Отчет о событиях доступен для формирования из карточки устройства.

1. Перейдите в карточку устройства, по которому требуется сформировать отчет о событиях.
2. Перейдите на вкладку "События".
3. Установите даты и время периода, за который необходимо получить информацию.
4. Нажмите на кнопку "Экспортировать".
5. В открывшемся окне подтвердите выгрузку отчета, нажав "Экспортировать".

Сформированный отчет в файле формата *.xlsx* будет скачан на ваше устройство в папку по умолчанию указанную в настройках браузера.

##### Отчет об операциях оборудования

Отчет об операциях доступен для формирования из карточки устройства.

1. Перейдите в карточку устройства, по которому требуется сформировать отчет об операциях;
2. Перейдите на вкладку "Операции";
3. Выберите даты и время периода, за который необходимо получить информацию;
4. Нажмите на кнопку "Экспортировать";
5. В открывшемся окне подтвердите выгрузку отчета, нажав "Экспортировать".

Сформированный отчет в файле формата *.xlsx* будет скачан на ваше устройство в папку по умолчанию указанную в настройках браузера.

##### Отчет о событиях группы устройств

Отчет о событиях группы устройств доступен для формирования из директории проводника.

1. Перейдите в проводник и откройте необходимую директорию;
2. Нажмите "Экспортировать";
3. Выберите тип отчета "Отчет событий устройств";
4. Нажмите "Далее";
5. Установите даты и время периода, за который необходимо получить информацию;
6. Отметьте устройства, по которым необходимо сформировать отчет. Для выбора устройств используйте навигацию в проводнике;
7. Нажмите на кнопку "Экспортировать".
   
Сформированный отчет в файле формата *.xlsx* будет скачан на ваше устройство в папку по умолчанию указанную в настройках браузера.

##### Отчет о конфигурациях устройств

Отчет о конфигурациях устройств доступен для формирования из директории проводника.

1. Перейдите в проводник и откройте необходимую директорию;
2. Нажмите "Экспортировать";
3. Выберите тип отчета "Отчет конфигурации устройств";
4. Нажмите "Далее";
5. Отметьте устройства, по которым необходимо сформировать отчет. Для выбора устройств используйте навигацию в проводнике;
6. Выберите поля, которые будут включены в отчет;
7. Нажмите на кнопку "Экспортировать".

Сформированный отчет в файле формата *.xlsx* будет скачан на ваше устройство в папку по умолчанию указанную в настройках браузера.

##### Отчет по забронированным юнитам стойки

Отчет по забронированным юнитам стойки доступен для формирования из карточки карточки стойки и проводника системы.

   Для формирования отчета из карточки устройства: 
1. Перейдите в карточку стойки, по которой требуется сформировать отчет;
2. В открывшемся окне выберите "Сформировать отчет".

> ***Кнопка выгрузки отчета будет активна только в случае наличия забронированных юнитов в стойке***

Сформированный отчет в файле формата *.xlsx* будет скачан на ваше устройство в папку по умолчанию указанную в настройках браузера.

   Для формирования отчета из проводника системы: 
1. Перейдите в проводник и откройте необходимую директорию;
2. Нажмите "Экспортировать";
3. Выберите тип отчета "Отчет по забронированным юнитам группы стоек";
4. Нажмите "Далее";
5. Отметьте стойки, по которым необходимо сформировать отчет. Для выбора нескольких объектов используйте навигацию в проводнике;
6. Нажмите на кнопку "Экспортировать".

##### Отчет по системе и ее сервисам

Отчет по системе и ее сервисам доступен для формирования из карточки системы.

1. Перейдите в карточку системы, по которой требуется сформировать отчет;
2. На вкладке "Общая информация" нажмите "Экспорт отчета";
3. Выберите поля, которые будут включены в отчет;
4. В открывшемся окне подтвердите выгрузку отчета, нажав "Экспортировать".

Сформированный отчет в файле формата *.xlsx* будет скачан на ваше устройство в папку по умолчанию указанную в настройках браузера.

> ***ВАЖНО! Стоит учитывать, что в указанное в отчетах время отображается в UTC формате***

### 5.9 Операции управления 

Список возможных операций расположен в разделе системы "Управление".
Операцию можно выполнить сразу или запланировать на будущий период времени.
Все операции управления возможно применить как к одному устройству, так и к группе устройств.

#### 5.9.1 Операции раздела "BMC"

Включают в себя следующие операции и имеют одинаковый порядок выполнения и привязаны к протоколам **IPMI**, **Redfish**, **SSH**: 

* Выключить:
  * Стандарт;
  * Soft.
* Включить:
  * Стандарт;
  * Soft.
* Перезагрузить консоль BMC:
  * Стандарт;
  * Soft.
* Перезагрузить BMC:
  * Стандарт;
  * Soft.
Изменить LED:
  * Включить;
  * Выключить;
  * Мигать.
* Обновить прошивку BMC:
  * API;
  * Raw IPMI.
* Обновить прошивку UEFI:
  * API;
  * Raw IPMI.
* Изменить загрузочный носитель BMC:
  * Параметр автоматического применения конфигурации загрузки:
    * Применять;
    * Не применять;
    * Игнорировать.
  * Параметр загрузочного носителя:
    * Bios;
    * Cdrom;
    * Diag;
    * Disk;
    * Floppy;
    * None;
    * Pxe;
    * Safe;
    * Usb.
  * Параметр переопределения источника загрузки:
    * Применять постоянно;
    * Применять один раз;
    * Не применять;
    * Игнорировать.
* Изменить загрузочный носитель Firmware:
  * UEFI;
  * Legacy.
* Изменить максимальное энергопотребления;
* Вызвать NMI прерывание;
* Эмулировать нажатие кнопки питания.

Для того, чтобы выполнить одну из вышеперечисленных операций перейдите в раздел "Управление".
Выберите необходимую операцию.

**Шаг 1 - Выбор протокола взаимодействия**

Выберите протокол взаимодействия.

**Шаг 2 - Настройка времени запуска**

Выберите запуск сейчас или запланируйте запуск выполнения операции

**Шаг 3 - Выбор устройств**

Выберите устройство для операции, доступное по выбранному протоколу и нажмите "Продолжить".

> ***По умолчанию будет установлен фильтр по выбранному протоколу взаимодействия, тем самым отображая только устройства, имеющие интерфейс выбранного протокола.***
> 
> ***Устройства, на которых выполняется операция в текущий момент времени не отображаются***

**Шаг 4 - Запуск операции**

Запустите операцию нажав кнопку "Запустить сейчас".

> ***В зависимости от уровня защищенности оборудования, могут быть другие сценарии запуска операции:***
> 
> * ***Перед запуском операции требуется ввести код **CAPTCHA*****
> 
> * ***"Добавить в ожидающие подтверждения" - задача будет отправлена в список ожидающих подтверждения для валидации запуска администратором.***

О запуске и результате операции на экран будет выведено уведомление.

##### Установка максимального энергопотребления

Данная операция доступна только по протоколу **Redfish**.
Для того, чтобы выполнить операцию по установке максимального энергопотребления перейдите в раздел "Управление".
Выберите необходимую операцию.

**Шаг 1 - Выбор протокола взаимодействия**

Выберите протокол взаимодействия.

**Шаг 2 - Настройка времени запуска**

Выберите запуск сейчас или запланируйте запуск выполнения операции
 
**Шаг 3 - Выбор устройств**

Выберите устройство для операции, доступное по выбранному протоколу и нажмите "Продолжить".

> ***По умолчанию будет установлен фильтр по выбранному протоколу взаимодействия, тем самым отображая только устройства, имеющие интерфейс выбранного протокола.***
> 
> ***По умолчанию НЕ показаны устройства, на которых выполняется операция в текущий момент времени.***

**Шаг 4 - Запуск операции**
 
Запустите операцию, нажав кнопку "Запустить сейчас".

> ***В зависимости от уровня защищенности оборудования, могут быть другие сценарии запуска операции:***
> 
> * ***Перед запуском операции требуется ввести код **CAPTCHA*****
> 
> * ***"Добавить в ожидающие подтверждения" - задача будет отправлена в список ожидающих подтверждения для валидации запуска администратором.***

О запуске и результате операции на экран будет выведено уведомление.

##### Перезагрузка и soft-перезагрузка BMC

Данные операции доступны только по протоколу **Redfish**.
Для того, чтобы выполнить операцию по перезагрузке BMC перейдите в раздел "Управление".
Выберите необходимую операцию.

**Шаг 1 - Выбор протокола взаимодействия**

Выберите протокол взаимодействия.

**Шаг 2 - Настройка времени запуска**

Выберите запуск сейчас или запланируйте запуск выполнения операции

**Шаг 3 - Выбор устройств**

Выберите устройство для операции, доступное по выбранному протоколу и нажмите "Продолжить".

> ***По умолчанию будет установлен фильтр по выбранному протоколу взаимодействия, тем самым отображая только устройства, имеющие интерфейс выбранного протокола.***
> 
> ***По умолчанию НЕ показаны устройства, на которых выполняется операция в текущий момент времени.***

**Шаг 4 - Запуск операции**

Запустите операцию нажав кнопку "Запустить сейчас".

> ***В зависимости от уровня защищенности оборудования, могут быть другие сценарии запуска операции:***
> 
> * ***Перед запуском операции требуется ввести код **CAPTCHA*****
> 
> * ***"Добавить в ожидающие подтверждения" - задача будет отправлена в список ожидающих подтверждения для валидации запуска администратором.***

О запуске и результате операции на экран будет выведено уведомление.

##### Обновление BIOS/UEFI и обновление BMC

Данные операции доступны по протоколам **IPMI** и **Redfish**.
Для того, чтобы выполнить операцию по обновлению BMC или BIOS/UEFI перейдите в раздел "Управление".
Выберите необходимую операцию.

**Шаг 1 - Выбор протокола взаимодействия**

Выберите протокол взаимодействия.

**Шаг 2 - Настройка времени запуска**

Выберите запуск сейчас или запланируйте запуск выполнения операции
 
**Шаг 3 - Выбор устройств**

Выберите устройство для операции, доступное по выбранному протоколу и нажмите "Продолжить".

**Шаг 4 - Выбор прошивки**

Выберите файл прошивки 

**Шаг 5 - Запуск операции**
    
Запустите операцию нажав кнопку "Запустить сейчас".

> ***В зависимости от уровня защищенности оборудования, могут быть другие сценарии запуска операции:***
> 
> * ***Перед запуском операции требуется ввести код **CAPTCHA*****
> 
> * ***"Добавить в ожидающие подтверждения" - задача будет отправлена в список ожидающих подтверждения для валидации запуска администратором.***

О запуске и результате операции на экран будет выведено уведомление.

##### Определить EMS, как центр идентификации пользователей BMC

EMS обеспечен технологией единого входа (**Single Sign On – SSO**) и позволяет администратору заходить на сетевой интерфейс модуля BMC ОМиУ из интерфейса системы без необходимости повторно вводить учетные данные, введенные на этапе входа в систему EMS.

Данная операция доступна по протоколу **Redfish**.

**Шаг 1 - Выбор протокола взаимодействия**

Выберите протокол взаимодействия.

**Шаг 2 - Настройка времени запуска**

Выберите запуск сейчас или запланируйте запуск выполнения операции

**Шаг 3 - Выбор устройств**

Выберите устройство для операции, доступное по выбранному протоколу и нажмите "Продолжить".

> ***По умолчанию будет установлен фильтр по выбранному протоколу взаимодействия, тем самым отображая только устройства, имеющие интерфейс выбранного протокола.***
> 
> ***По умолчанию НЕ показаны устройства, на которых выполняется операция в текущий момент времени.***

**Шаг 4 - Настройка и запуск**

Для добавления или удаления устройства к операции нажмите кнопку "Добавить"/"Удалить"
Запустите операцию нажав кнопку "Запустить сейчас".

> ***В зависимости от уровня защищенности оборудования, могут быть другие сценарии запуска операции:***
> 
> * ***Перед запуском операции требуется ввести код **CAPTCHA*****
> 
> * ***"Добавить в ожидающие подтверждения" - задача будет отправлена в список ожидающих подтверждения для валидации запуска администратором.***

О запуске и результате операции на экран будет выведено уведомление.

Теперь пользователи, с активным флагом "Включить в центр идентификации пользователя BMC" в учетной записи, могут получить доступ к BMC консоли с учетными данными, заведенными в системе EMS. 

Проверьте доступ к BMC консоли:
1. Перейдите в карточку устройства, по которому была выполнена операция "Определить EMS, как центр идентификации пользователей BMC".
2. Откройте вкладку "Сети".
3. Выберите инструмент "Быстрый доступ в BMC консоль" или "Открыть BMC консоль". Выполнен авторизованный в ход в BMC консоль.

##### Смена режима загрузки BIOS/UEFI

Данная операция доступна только по протоколу **Redfish**.
Для того, чтобы выполнить операцию по смене режима загрузки BIOS/UEFI перейдите в раздел "Управление".
Выберите необходимую вам операцию.

**Шаг 1 - Выбор протокола взаимодействия**

Выберите протокол взаимодействия.

**Шаг 2 - Настройка времени запуска**

Выберите запуск сейчас или запланируйте запуск выполнения операции

**Шаг 3 - Выбор устройств**

Выберите устройство для операции, доступное по выбранному протоколу и нажмите "Продолжить".

> ***По умолчанию будет установлен фильтр по выбранному протоколу взаимодействия, тем самым отображая только устройства, имеющие интерфейс выбранного протокола.***
> 
> ***По умолчанию НЕ показаны устройства, на которых выполняется операция в текущий момент времени.***

**Шаг 4 - Настройка**

 Для добавления или удаления устройства к операции нажмите кнопку "Добавить"/"Удалить"

Выберите параметр:

* UEFI;
* Legacy.

**Шаг 5 - Запуск операции**

Запустите операцию нажав кнопку "Запустить сейчас".

> ***В зависимости от уровня защищенности оборудования, могут быть другие сценарии запуска операции:***
> 
> * ***Перед запуском операции требуется ввести код **CAPTCHA*****
> 
> * ***"Добавить в ожидающие подтверждения" - задача будет отправлена в список ожидающих подтверждения для валидации запуска администратором.***

О запуске и результате операции на экран будет выведено уведомление.

##### Смена загрузочного носителя

Данная операция доступна по протоколам **IPMI** и **Redfish**.
Для того, чтобы выполнить операцию по смене загрузочного носителя перейдите в раздел "Управление".
Выберите необходимую вам операцию.

**Шаг 1 - Выбор протокола взаимодействия**

Выберите протокол взаимодействия.

**Шаг 2 - Настройка времени запуска**

Выберите запуск сейчас или запланируйте запуск выполнения операции

**Шаг 4 - Выбор устройств**

Выберите устройство для операции, доступное по выбранному протоколу и нажмите "Продолжить".

> ***По умолчанию будет установлен фильтр по выбранному протоколу взаимодействия, тем самым отображая только устройства, имеющие интерфейс выбранного протокола.***
> 
> ***По умолчанию НЕ показаны устройства, на которых выполняется операция в текущий момент времени.***

**Шаг 4 - Настройка**

Для добавления или удаления устройства к операции нажмите кнопку "Добавить"/"Удалить".

Выберите конфиг загрузочного носителя:

* Отсутствует (None);
* Диск (Disk);
* Безопасный режим (Safe);
* Режим диагностики (Diag);
* CDROM (Cdrom);
* BIOS/UEFI (Bios);
* PXE (Pxe);
* Floppy-диск (Floppy);
* USB (Usb).

При подключении по протоколу **Redfish** возможно указать дополнительные конфигурации:

* BootSourceOverrideEnabled - переопределение загрузочного носителя.
  * Выключено;
  * Один раз;
  * Постоянно.
* AutomaticRetryConfig - автоматический повтор конфигурации.
  * Выключено;
  * Один раз;
  * Постоянно.

**Шаг 5 - Запуск операции**

Запустите операцию нажав кнопку "Запустить сейчас".

> ***В зависимости от уровня защищенности оборудования, могут быть другие сценарии запуска операции:***
>
> * ***Перед запуском операции требуется ввести код **CAPTCHA*****
> * ***"Добавить в ожидающие подтверждения" - задача будет отправлена в список ожидающих подтверждения для валидации запуска администратором.***

О запуске и результате операции на экран будет выведено уведомление.

#### 5.9.2 Операции раздела "Коммутаторы"

##### Сохранение настроек коммутаторов Cumulus

Данная операция доступна только по протоколу **SSH**.
Для того, чтобы выполнить операцию по сохранению настроек коммутатора перейдите в раздел "Управление".
Выберите необходимую операцию.

**Шаг 1 - Выбор протокола взаимодействия**

Выберите протокол взаимодействия.

> ***По умолчанию будет установлен фильтр по выбранному протоколу взаимодействия, тем самым отображая только устройства, имеющие интерфейс выбранного протокола.***

**Шаг 2 - Выбор устройств**

Выберите устройство для операции, доступное по выбранному протоколу и нажмите "Продолжить".

> ***По умолчанию НЕ показаны устройства, на которых выполняется операция в текущий момент времени.***

**Шаг 3 - Настройка**

Для добавления или удаления устройства к операции нажмите кнопку "Добавить"/"Удалить".

**Шаг 4 - Запуск операции**

Нажмите "Настроить параметры запуска".
Запустите операцию нажав кнопку "Запустить сейчас".

> ***В зависимости от уровня защищенности оборудования, могут быть другие сценарии запуска операции:***
>
> * ***Перед запуском операции требуется ввести код **CAPTCHA*****
> * ***"Добавить в ожидающие подтверждения" - задача будет отправлена в список ожидающих подтверждения для валидации запуска администратором.***

О запуске и результате операции на экран будет выведено уведомление. Файл настроек сохранится в репозитории системы в разделе "Конфигурации коммутаторов".

##### Изменение настроек коммутаторов Cumulus

Данная операция доступна только по протоколу **SSH**.
Для того, чтобы выполнить операцию по изменению настроек коммутатора перейдите в раздел "Управление".
Выберите необходимую операцию.

**Шаг 1 - Выбор протокола взаимодействия**

Выберите протокол взаимодействия.

> ***По умолчанию будет установлен фильтр по выбранному протоколу взаимодействия, тем самым отображая только устройства, имеющие интерфейс выбранного протокола.***

**Шаг 2 - Выбор устройств**

Выберите устройство для операции, доступное по выбранному протоколу и нажмите "Продолжить".

> ***По умолчанию будет установлен фильтр по выбранному протоколу взаимодействия, тем самым отображая только устройства, имеющие интерфейс выбранного протокола.***
> 
> ***По умолчанию НЕ показаны устройства, на которых выполняется операция в текущий момент времени.***

**Шаг 3 - Выбор файла конфигурации коммутатора**

Выберите необходимый файл конфигурации коммутатора из хранящихся в репозитории и нажмите кнопку "Выбрать".

> ***При необходимости загрузите новый файл конфигурации коммутатора нажав кнопку "Добавить"***

**Шаг 4 - Настройка**

Для добавления или удаления устройства к операции нажмите кнопку "Добавить"/"Удалить".

**Шаг 5 - Запуск операции**

Запустите операцию нажав кнопку "Запустить сейчас".

> ***В зависимости от уровня защищенности оборудования, могут быть другие сценарии запуска операции:***
>
> * ***Перед запуском операции требуется ввести код **CAPTCHA*****
> * ***"Добавить в ожидающие подтверждения" - задача будет отправлена в список ожидающих подтверждения для валидации запуска администратором.***

О запуске и результате операции на экран будет выведено уведомление. Файл настроек сохранится в репозитории системы в разделе "Конфигурации коммутаторов".

#### 5.9.3 Операции раздела "Linux"

Включают в себя следующие операции:
* Выключить:
  * Стандартный;
  * Sudo.
* Перезагрузить:
  * Стандартный;
  * Sudo.
* Установить Linux агента:
  * Стандартный;
  * Sudo.
* Установить ПО с помощью скрипта:
  * Стандартный;
  * Sudo.
* Выполнить скрипт:
  * Стандартный;
  * Sudo.


Для успешной установки ОС по сети должны выполняться следующие предусловия:

- PXE сервер должен находиться в той же подсети, что и целевое оборудование (машина, на которую требуется установить ОС,
физическая или виртуальная)

- DHCP сервер должен быть настроен для работы с сетевой установкой ОС. Для этого в его настройках должны быть указаны значения для опций `filename` и `next-server`.

Ниже приведен пример установки этих опций для работы c PXE сервером в составе EMS:

```
cat dhcpd.conf
#
# DHCP Server Configuration file.
#   see /usr/share/doc/dhcp-server/dhcpd.conf.example
#   see dhcpd.conf(5) man page
#

subnet 192.168.1.0 netmask 255.255.255.0 {
  range 192.168.1.100 192.168.1.170;
  option domain-name-servers 10.1.15.10, 46.8.32.254;
  option routers 192.168.1.1;
  option broadcast-address 192.168.1.255;
  default-lease-time 600;
  max-lease-time 7200;
  next-server 192.168.1.5;
}

option client-architecture code 93 = unsigned integer 16;
if exists user-class and option user-class = "iPXE" {
    filename "install.ipxe";
} elsif option client-architecture = 00:00 {
    filename "undionly.kpxe";
} else {
    filename "ipxe.efi";
}
```

В примере в качестве адреса PXE сервера указан адрес `192.168.1.5.` В других окружениях он будет отличаться.
Также, в этом примере используется гибкая установка опции `filename`, которая зависит от архитектуры целевого оборудования, которое может не поддерживать `iPXE`. Эту конфигурацию следует копировать без изменений.

> **На текущий момент в системе есть возможность настройки получения оповещений о начале и окончании установки операционной системы на оборудование с помощью http-запросов на целевой сервер, который регистрирует соответствующие события. Для того, чтобы оборудование, на которое устанавливается ОС выполнило запрос регистрации события, необходимо внести соответствующие параметры в файл автоустановки (Kickstart/Preseed). Для удобства пользователя, применяются шаблоны `netboot_start` и `netboot_finish`, на место которых будет автоматически подставлена нужная строка.**  
>
>**Параметры файлов автоустановки зависят от типа и версии устанавливаемой ОС.**

***Примеры структуры Kickstart/Preseed  для разных ОС:***

* Redhat/ESXi

В kickstart-файле должны присутствовать две секции: `%pre` и `%post`. В этих секциях должны располагаться команды, которые
осуществляют http-запросы. Каждая из указанных секций должна заканчиваться специальной строкой `%end` (не обязательно для ESXI).
В интерпретаторе kickstart файлов в дистрибутивах Redhat и Esxi используется `curl`.

**Centos8**

```
# Turning on text-mode installation (little quicker than GUI)
text

# Setting up authentication and keyboard
auth --enableshadow --passalgo=sha512
keyboard --vckeymap=us --xlayouts='us'
>z

# Installation files source (CentOS-7.0-1406-x86_64-Minimal.iso)
cdrom

# Using only primary disk, ignoring others
ignoredisk --only-use=nvme0n1

# Setting up language to English
lang en-US.UTF-8

# Setting up network interface to DHCP
network --bootproto=dhcp --hostname=centos-ks.local --activate --onboot yes

# Root password (remember that plaintext only for information purposes)
rootpw --plaintext centos

# Setting up firewall and enabling SSH for remote management
firewall --enabled --service=ssh

# Setting timezone
timezone Europe/Warsaw --isUtc

# Setting up Security-Enhanced Linux into enforcing
selinux --enforcing

# Setting up MBR
bootloader --location=mbr --boot-drive=nvme0n1

# Setting up Logical Volume Manager and autopartitioning
clearpart --all --drives=nvme0n1 --initlabel
autopart --type=lvm

# Eject cdrom and reboot
reboot --eject

# Installing only packages for minimal install
%packages
@Core
chrony
%end

%pre
netboot_start
%end

%post
netboot_finish
%end
```

**ESXi 7**

```
cat ESXi-7.0U3b-18905247/ks.cfg
vmaccepteula
install --firstdisk --overwritevmfs --novmfsondisk

#network --bootproto=static --ip=10.1.48.111 --netmask=255.255.255.0 --gateway=10.1.48.1 --hostname=esxi-machine-7 --nameserver=10.1.48.1
network --bootproto=dhcp
rootpw 1qaz_@WSX

reboot

%firstboot --interpreter=busybox

# Enable SSH
vim-cmd hostsvc/enable_ssh
vim-cmd hostsvc/start_ssh

# Enable ESXi Shell
vim-cmd hostsvc/enable_esx_shell
vim-cmd hostsvc/start_esx_shell

# Suppress Shell warning
esxcli system settings advanced set -o /UserVars/SuppressShellWarning -i 1

# NTP
esxcli system ntp set -s de.pool.ntp.org
esxcli system ntp set -e 1

%pre --interpreter=busybox
netboot_start

%post --interpreter=busybox --ignorefailure=true
localcli network firewall set --default-action true
localcli network firewall set --enabled false
netboot_finish
localcli network firewall set --default-action false
localcli network firewall set --enabled true
```

* Ubuntu не ниже 20 версии

В `yaml` файле, описывающем ход установки, должны присутствовать секции `early-commands` и `late-commands`. Они должны быть расположены
внутри главной структуры `autoinstall`. В этих секциях должны быть прописаны команды, осуществляющие `http` запрос на нужный нам URL.
В интерпретаторе файлов автоустановки Ubuntu, начиная с версии 20, используется `wget`.

```
autoinstall:
  early-commands:
    - netboot_start
  late-commands:
    - netboot_finish
  apt:
    geoip: true
    preserve_sources_list: false
    primary:
    - arches: [amd64, i386]
      uri: http://in.archive.ubuntu.com/ubuntu
    - arches: [default]
      uri: http://ports.ubuntu.com/ubuntu-ports
  identity: {hostname: bssinit, password: $1$JsptJh92$BglvbjWY3BytsMww41Mg20,
    realname: support, username: support}
  keyboard: {layout: us, toggle: null, variant: ''}
  locale: en_US.UTF-8
  network:
    ethernets:
      eno49:
        critical: true
        dhcp-identifier: mac
        dhcp4: true
        nameservers:
          addresses: [127.0.0.1]
      eno50: {dhcp4: true}
    version: 2
  ssh:
    allow-pw: true
    authorized-keys: []
    install-server: true
  updates: security
  version: 1
```

* Debian/Ubuntu ниже 20 версии

В preseed-файле должны присутствовать две секции: `d-i preseed/early_command string` и `d-i preseed/late_command string`. В этих секциях
должны располагаться команды, которые осуществляют http-запросы.

Для Debian 11 в секции `late_command` показано, как использовать несколько команд подряд:

```
d-i preseed/early_command string \
netboot_start

# Locale
d-i debian-installer/locale string en_US
d-i debian-installer/locale string en_US.UTF-8
d-i keyboard-configuration/xkb-keymap select us

# Network
d-i netcfg/enable boolean true
d-i netcfg/choose_interface select auto
d-i netcfg/hostname string unassigned-preseed
d-i netcfg/get_hostname string unassigned-preseed
d-i netcfg/get_domain string local

# Apt
d-i apt-setup/cdrom/set-first boolean false
d-i apt-setup/cdrom/set-next boolean false
d-i apt-setup/cdrom/set-failed boolean false

d-i hw-detect/load_firmware boolean false
d-i hw-detect/load_media boolean false

d-i mirror/country string manual
d-i mirror/http/hostname string 10.1.48.1:8080
#d-i mirror/http/hostname string 192.168.1.5:8080
d-i mirror/http/directory string /netboot/iso_dir
d-i mirror/http/proxy string

# Users/passwords
d-i passwd/root-login boolean true
d-i passwd/make-user boolean true
d-i passwd/root-password password 1qaz@WSX
d-i passwd/root-password-again password 1qaz@WSX
d-i passwd/user-fullname string support
d-i passwd/username string support
d-i passwd/user-password password 1qaz@WSX
d-i passwd/user-password-again password 1qaz@WSX

# Clock
d-i clock-setup/utc boolean true
d-i time/zone string Europe/Moscow
d-i clock-setup/ntp boolean true

# Disk partition
d-i partman-auto/method string regular
d-i partman-lvm/device_remove_lvm boolean true
d-i partman-md/device_remove_md boolean true
d-i partman-lvm/confirm boolean true
d-i partman-auto/choose_recipe select atomic
d-i partman-partitioning/confirm_write_new_label boolean true
d-i partman/choose_partition select finish
d-i partman/confirm boolean true
d-i partman/confirm_nooverwrite boolean true

# Packages
d-i base-installer/install-recommends boolean false
d-i base-installer/kernel/image string linux-image-amd64
d-i base-installer/kernel/skip-install boolean true

d-i debian-installer/allow_unauthenticated string true
d-i apt-setup/local0/comment string local mirror
d-i apt-setup/local0/repository string [allow-insecure=yes,trusted=yes] http://10.1.48.1:8080/netboot/iso_dir stable main
d-i apt-setup/local0/key string http://10.1.48.1:8080/netboot/mykey.pub
#d-i apt-setup/local0/repository string [allow-insecure=yes,trusted=yes] http://192.168.1.5:8080/netboot/iso_dir stable main
#d-i apt-setup/local0/key string http://192.168.1.5:8080/netboot/mykey.pub
d-i apt-setup/check_valid_until boolean false
tasksel tasksel/first multiselect standard, ssh-server

popularity-contest popularity-contest/participate boolean false

# Boot
d-i grub-installer/only_debian boolean true
d-i grub-installer/with_other_os boolean true
d-i grub-installer/force-efi-extra-removable boolean true
d-i grub-installer/progress/step_force_efi_removable boolean true
d-i grub-installer/bootdev string default

# Custom late commands
d-i preseed/late_command string apt-install linux-image-amd64; in-target update-grub; netboot_finish;

# Finish
d-i finish-install/reboot_in_progress note
```
  
##### Установка ОС из ISO-файла

Данная операция доступна только по протоколу **PXE**.
Для того, чтобы выполнить операцию по установке ОС из ISO-файла перейдите в раздел "Управление".
Выберите необходимую операцию.

**Шаг 1 - Выбор протокола взаимодействия**

Выберите протокол взаимодействия.

**Шаг 2 - Настройка времени запуска**

Выберите запуск сейчас или запланируйте запуск выполнения операции

**Шаг 3 - Выбор операционной системы**

Выберите из предложенного списка одну из операционных систем.

> ***Выбранная операционная система будет автоматически отображать репозиторий с данным типом ОС и Kickstart/Preseed файлами***
> 
> ***Учитывайте что для операционной системы Alt Linux требуется 2 дополнительных установочных файла (Kickstart/Preseed файл и Схема разбивки жёсткого диска)***

**Шаг 4 - Выбор ISO-образа**

Выберите необходимый файл ISO-образа из хранящихся в репозитории.

> ***При необходимости загрузите новый файл прошивки в репозиторий системы.***

**Шаг 5 - Выбор устройств**

Выберите устройство для операции, доступное по выбранному протоколу и нажмите "Продолжить".

> ***По умолчанию будет установлен фильтр по выбранному протоколу взаимодействия, тем самым отображая только устройства, имеющие интерфейс выбранного протокола.***
> 
> ***По умолчанию НЕ показаны устройства, на которых выполняется операция в текущий момент времени.***

**Шаг 6 - Настройка**

Для добавления или удаления устройства к операции нажмите кнопку "Добавить"/"Удалить".

Укажите новый IP-адрес ОС и маску подсети.
 
**Шаг 7 - Запуск операции**

Запустите операцию нажав кнопку "Запустить сейчас".

> ***В зависимости от уровня защищенности оборудования, могут быть другие сценарии запуска операции:***
>
> * ***Перед запуском операции требуется ввести код **CAPTCHA*****
> * ***"Добавить в ожидающие подтверждения" - задача будет отправлена в список ожидающих подтверждения для валидации запуска администратором.***

О запуске и результате операции на экран будет выведено уведомление.

##### Netboot установка ОС

Данная операция доступна только по протоколу **PXE**.
Для того, чтобы выполнить операцию по установке ОС из ISO-файла перейдите в раздел "Управление".
Выберите необходимую операцию.

**Шаг 1 - Выбор протокола взаимодействия**

Выберите протокол взаимодействия.

**Шаг 2 - Настройка времени запуска**

Выберите запуск сейчас или запланируйте запуск выполнения операции.

**Шаг 3 - Выбор операционной системы**

Выберите из предложенного списка одну из операционных систем.

> ***Выбранная операционная система будет автоматически отображать репозиторий с данным типом ОС и Kickstart/Preseed файлами***
> 
> ***Учитывайте что для операционной системы Alt Linux требуется 2 дополнительных установочных файла (Kickstart/Preseed файл и Схема разбивки жёсткого диска)***

**Шаг 4 - Указание адреса установочного файла ОС**

Укажите URL репозитория в котором находится целевой установочный файл

> ***При необходимости загрузите новый файл прошивки в репозиторий системы.***

**Шаг 5 - Выбор устройств**

Выберите устройство для операции, доступное по выбранному протоколу и нажмите "Продолжить".

> ***По умолчанию будет установлен фильтр по выбранному протоколу взаимодействия, тем самым отображая только устройства, имеющие интерфейс выбранного протокола.***
> 
> ***По умолчанию НЕ показаны устройства, на которых выполняется операция в текущий момент времени.***

**Шаг 6 - Настройка**

Для добавления или удаления устройства к операции нажмите кнопку "Добавить"/"Удалить".

Укажите новый IP-адрес ОС и маску подсети.
 
**Шаг 7 - Запуск операции**

Запустите операцию нажав кнопку "Запустить сейчас".

> ***В зависимости от уровня защищенности оборудования, могут быть другие сценарии запуска операции:***
>
> * ***Перед запуском операции требуется ввести код **CAPTCHA*****
> * ***"Добавить в ожидающие подтверждения" - задача будет отправлена в список ожидающих подтверждения для валидации запуска администратором.***

О запуске и результате операции на экран будет выведено уведомление.

##### Установка агента

Данная операция доступна только по протоколу **SSH**.
Для того, чтобы выполнить операцию по установке агента перейдите в раздел "Управление".
Выберите необходимую операцию.

**Шаг 1 - Выбор протокола взаимодействия**

Выберите протокол взаимодействия.

**Шаг 2 - Настройка времени запуска**

Выберите запуск сейчас или запланируйте запуск выполнения операции.

**Шаг 3 - Выбор устройств**

Выберите устройство для операции, доступное по выбранному протоколу и нажмите "Продолжить".

> ***По умолчанию будет установлен фильтр по выбранному протоколу взаимодействия, тем самым отображая только устройства, имеющие интерфейс выбранного протокола.***
> 
> ***По умолчанию НЕ показаны устройства, на которых выполняется операция в текущий момент времени.***

**Шаг 4 - Настройка**

Для добавления или удаления устройства к операции нажмите кнопку "Добавить"/"Удалить".

Укажите тип установки:

* Init;
* Native.

> ***В случае установки агента на ОМиУ через `Native`, агент будет запущен в фоновом режиме и при перезагрузке оборудования рабочий процесс будет завершен. Для последующей работы агента необходимо произвести повторную установку.***
> 
> ***При установке агента на ОМиУ через `Init`, агент будет запущен через подсистему инициализация и управления `systemd`, вследствие этого при перезагрузке оборудования агент запустится и продолжит работу автоматически.***

Укажите тип вызова:

* Bash;
* Sh.

При необходимости поставьте отметку "Выполнить как sudo", позволяющую выполнить операцию от имени администратора (root).

**Шаг 5 - Запуск операции**

Запустите операцию нажав кнопку "Запустить сейчас".

> ***В зависимости от уровня защищенности оборудования, могут быть другие сценарии запуска операции:***
>
> * ***Перед запуском операции требуется ввести код **CAPTCHA*****
> 
> * ***"Добавить в ожидающие подтверждения" - задача будет отправлена в список ожидающих подтверждения для валидации запуска администратором.***
> 

О запуске и результате операции на экран будет выведено уведомление.

##### Установка ПО с помощью sh/bash скрипта

Данная операция доступна только по протоколу **SSH**.
Для того, чтобы выполнить операцию по установке ПО с помощью sh/bash скрипта перейдите в раздел "Управление".
Выберите необходимую операцию.

**Шаг 1 - Выбор протокола взаимодействия**

Выберите протокол взаимодействия.

**Шаг 2 - Настройка времени запуска**

Выберите запуск сейчас или запланируйте запуск выполнения операции.

**Шаг 3 - Выбор устройств**

Выберите устройство для операции, доступное по выбранному протоколу и нажмите "Продолжить".

> ***По умолчанию будет установлен фильтр по выбранному протоколу взаимодействия, тем самым отображая только устройства, имеющие интерфейс выбранного протокола.***
> 
> ***По умолчанию НЕ показаны устройства, на которых выполняется операция в текущий момент времени.***

**Шаг 4 - Выбор образа ПО**

Выберите необходимый файл образа ПО из хранящихся в репозитории и нажмите кнопку "Выбрать".

> ***При необходимости загрузите новый файл образа ПО нажав кнопку "Добавить"***

**Шаг 5 - Выбор файла bash скрипта**

Выберите необходимый файл bash скрипта из хранящихся в репозитории и нажмите кнопку "Выбрать".

> ***При необходимости загрузите новый файл bash скрипта нажав кнопку "Добавить"***

**Шаг 6 - Настройка**

Для добавления или удаления устройства к операции нажмите кнопку "Добавить"/"Удалить".

Выберите тип вызова:

* Bash;
* Sh.

**Шаг 7 - Запуск операции**

Запустите операцию нажав кнопку "Запустить сейчас".

> ***В зависимости от уровня защищенности оборудования, могут быть другие сценарии запуска операции:***
>
> * ***Перед запуском операции требуется ввести код **CAPTCHA*****
> * ***"Добавить в ожидающие подтверждения" - задача будет отправлена в список ожидающих подтверждения для валидации запуска администратором.***

О запуске и результате операции на экран будет выведено уведомление.

##### Выполнение sh/bash скрипта

Данная операция доступна только по протоколу **SSH**.
Для того, чтобы выполнить операцию по выполнению sh/bash скрипта перейдите в раздел "Управление".
Выберите необходимую операцию.

**Шаг 1 - Выбор протокола взаимодействия**

Выберите протокол взаимодействия.

**Шаг 2 - Настройка времени запуска**

Выберите запуск сейчас или запланируйте запуск выполнения операции.

**Шаг 3 - Выбор устройств**

Выберите устройство для операции, доступное по выбранному протоколу и нажмите "Продолжить".

> ***По умолчанию будет установлен фильтр по выбранному протоколу взаимодействия, тем самым отображая только устройства, имеющие интерфейс выбранного протокола.***
> 
> ***По умолчанию НЕ показаны устройства, на которых выполняется операция в текущий момент времени.***

**Шаг 4 - Выбор файла bash скрипта**

Выберите необходимый файл bash скрипта из хранящихся в репозитории и нажмите кнопку "Выбрать".

> ***При необходимости загрузите новый файл bash скрипта нажав кнопку "Добавить"***

**Шаг 5 - Настройка**

Для добавления или удаления устройства к операции нажмите кнопку "Добавить"/"Удалить".

Укажите тип вызова:

* Bash;
* Sh.

При необходимости поставьте отметку "Выполнить как sudo", позволяющую выполнить операцию от имени администратора (root).

**Шаг 6 - Запуск операции**

Запустите операцию нажав кнопку "Запустить сейчас".

> ***В зависимости от уровня защищенности оборудования, могут быть другие сценарии запуска операции:***
>
> * ***Перед запуском операции требуется ввести код **CAPTCHA*****
> * ***"Добавить в ожидающие подтверждения" - задача будет отправлена в список ожидающих подтверждения для валидации запуска администратором.***

О запуске и результате операции на экран будет выведено уведомление.

#### 5.9.4 Операции раздела "Windows"

Включают в себя следующие операции:
* Выполнить скрипт:
  * Стандартный;
  * От имени администратора.

##### Выполнение PowerShell скрипта

Данная операция доступна только по протоколу **WMI**.
Для того, чтобы выполнить операцию по выполнению PowerShell скрипта перейдите в раздел "Управление".
Выберите необходимую операцию.

**Шаг 1 - Выбор протокола взаимодействия**

Выберите протокол взаимодействия.

**Шаг 2 - Выбор устройств**

Для добавления или удаления устройства к операции нажмите кнопку "Добавить"/"Удалить".

> ***По умолчанию будет установлен фильтр по выбранному протоколу взаимодействия, тем самым отображая только устройства, имеющие интерфейс выбранного протокола.***
> 
> ***По умолчанию НЕ показаны устройства, на которых выполняется операция в текущий момент времени.***

**Шаг 3 - Выбор файла скрипта**

Выберите необходимый файл скрипта из хранящихся в репозитории и нажмите кнопку "Выбрать".

> ***При необходимости загрузите новый файл в репозиторий***

**Шаг 4 - Запуск операции**

Запустите операцию нажав кнопку "Запустить сейчас".

> ***В зависимости от уровня защищенности оборудования, могут быть другие сценарии запуска операции:***
>
> * ***Перед запуском операции требуется ввести код **CAPTCHA*****
> * ***"Добавить в ожидающие подтверждения" - задача будет отправлена в список ожидающих подтверждения для валидации запуска администратором.***

О запуске и результате операции на экран будет выведено уведомление.

## 6 Техническая поддержка

При возникновении вопросов при эксплуатации системы обратитесь в техническую поддержку.  
Техническая поддержка осуществляется в стандартные рабочие дни с 09:00 до 18:00 по московскому времени:     

* Обращения через электронную почту `sd@gagarin.me`        
* Телефоны: +7 (963) 996-84-50; +7 (963) 999-67-05.   

## Приложения

### Перечень ссылочных документов

* Руководство администратора Системы EMS v4.1.1;
* Руководство по инсталляции Системы EMS v4.1.1 в режиме одной ноды;
* Руководство по инсталляции EMS v4.1.1 в режиме HA на 3 дата-центра;
* Руководство по обновлению Системы EMS с версии 3.5.3 до версии 4.1.1 в режиме одной ноды;  
* Программа и методика испытаний системы EMS v4.1.1.


